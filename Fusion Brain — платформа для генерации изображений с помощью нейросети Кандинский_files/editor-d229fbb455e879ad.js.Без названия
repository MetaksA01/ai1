(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4154],{96281:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/editor",function(){return a(66438)}])},7550:function(e,t,a){"use strict";a.d(t,{L:function(){return l}});var s,l,o=a(85893);a(67294);var n=a(93967),i=a.n(n),r=a(80209),c=a.n(r);(s=l||(l={})).CLEAR="clear",s.FILL="fill",s.PRIMARY="primary";let u=e=>{let{children:t,className:a,active:s,buttonType:n=l.PRIMARY,...r}=e;return(0,o.jsx)("button",{className:i()(c().root,a,c()[n],{[c().active]:s}),...r,children:t})};t.Z=u},33362:function(e,t,a){"use strict";a.d(t,{Z:function(){return d},C:function(){return p}});var s=a(85893),l=a(67294),o=a(62372),n=a(93967),i=a.n(n),r=a(91214),c=a.n(r);let u=e=>{let{children:t,className:a}=e;return(0,s.jsx)("div",{className:i()(c().root,a),children:t})};var d=u;let h=l.forwardRef((e,t)=>{let{disabled:a,trigger:n,isOpen:i,children:r,overflowContainer:c=!1,closeOnClick:u=!0,onClose:d,onOpen:h,placement:p,triggerOffset:m,triggerOnHover:v}=e,[g,y]=(0,l.useState)(!1),_=!a&&(void 0===i?g:i),x=(0,l.useCallback)(e=>()=>{v&&y(e)},[v]),f=(0,l.useCallback)(()=>{v||(d?d():y(!1))},[d,v]),b=(0,l.useCallback)(()=>{v||(h?h():y(!0))},[h,v]),{renderLayer:w,triggerProps:D,layerProps:j}=(0,o.sJ)({isOpen:_,auto:!0,onParentClose:()=>{d&&d()},overflowContainer:c,placement:p||"bottom-end",possiblePlacements:["bottom-start","bottom-end","bottom-center","top-start","top-center","top-end"],triggerOffset:m||8,onDisappear:e=>{"full"===e&&f()},onOutsideClick:f,container:document.getElementById("app-container")}),k=l.cloneElement(n,{onClick:()=>{_?f():b()},onMouseEnter:x(!0),onMouseLeave:x(!1),...D,...n.props}),C=(0,l.useCallback)(()=>{u&&f()},[u,f]);return(0,s.jsxs)(s.Fragment,{children:[k,_&&w((0,s.jsx)("div",{ref:t,onClick:C,...j,style:{...j.style,zIndex:2e3},children:r}))]})});h.displayName="hint";var p=h},87428:function(e,t,a){"use strict";a.d(t,{K:function(){return l}});var s,l,o=a(85893),n=a(67294),i=a(93967),r=a.n(i),c=a(29613),u=a(97418),d=a(92901),h=a.n(d),p=a(51526),m=a(11610);(s=l||(l={})).LEFT="left",s.RIGHT="right",s.FILL_ROW="fillRow",s.FILL_COLUMN="fillColumn";let v=e=>{let{isOpen:t,buttons:a=[],loading:s,children:i,wrapComponent:d,contentClassName:v,onClose:g,footerType:y=l.LEFT}=e,[_,x]=(0,n.useState)(!0),f=(0,n.useCallback)(e=>{(void 0===(null==e?void 0:e.opacity)||0===e.opacity)&&(null==g||g())},[g]),b=(0,n.useCallback)(()=>{x(!1)},[]),w=(0,n.useMemo)(()=>a.map(e=>"close"===e.key?n.cloneElement(e,{onClick:b}):e),[a,b]),D=(0,n.useMemo)(()=>(0,o.jsx)("div",{className:r()(h().overlay,{[h().hidden]:!_}),onMouseDown:b,children:(0,o.jsx)(p.M,{children:_&&(0,o.jsxs)(m.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{duration:.3},className:h().wrap,onAnimationComplete:f,onMouseDown:e=>e.stopPropagation(),children:[s&&(0,o.jsx)(c.aN,{}),(0,o.jsx)("div",{onTouchMove:e=>{e.stopPropagation()},className:r()(h().content,v,"scrollbar-fb"),children:i}),w.length&&(0,o.jsx)("div",{className:r()(h().footer,h()[y]),children:n.Children.toArray(w)})]})})}),[_,b,f,s,v,i,w,y]);return t?(0,o.jsx)(u.H,{open:t,onClose:b,children:d?n.cloneElement(d,{},D):D}):null};t.Z=v},97418:function(e,t,a){"use strict";a.d(t,{H:function(){return r}});var s=a(67294),l=a(73935);let o=["boxSizing","overflow","paddingRight","position","top","width","filter"];var n=class{copyStyles(e,t,a){a&&a.forEach(a=>{t[a]=e[a]||""})}freeze(){let e=document.body.style,t=this.frozen||"fixed"===e.position&&"hidden"===e.overflow;if(!t){let t=window.innerWidth-document.body.clientWidth;this.scrollPosition=window.pageYOffset,this.copyStyles(e,this.savedStyles,o),e.top="".concat(-this.scrollPosition,"px"),e.position="fixed",e.overflow="hidden",e.width="100%",e.paddingRight="".concat(t,"px"),e.boxSizing="border-box";let a=document.getElementById("app");a&&(a.style.filter="saturate(1)",a.style.transition="filter 2s",a.style.filter="saturate(0)"),this.frozen=!0}}unfreeze(){if(!this.frozen)return;this.savedStyles&&(this.copyStyles(this.savedStyles,document.body.style,o),this.savedStyles={});let e=document.getElementById("app");e&&(e.style.removeProperty("transition"),e.style.removeProperty("filter")),window.scrollTo(0,this.scrollPosition),this.frozen=!1}constructor(){this.frozen=!1,this.scrollPosition=0,this.savedStyles={}}};let i=new n;class r extends s.PureComponent{componentDidMount(){let{open:e}=this.props;e&&this.setState({mounted:!0}),document.addEventListener("keydown",this.escFunction,!1)}componentDidUpdate(e,t){let{open:a}=this.props,{open:s}=e,{mounted:l}=this.state,{mounted:o}=t;!a||s||l||this.setState({mounted:!0}),l&&!o&&a||l&&a&&!s?this.open():!a&&s&&this.close()}componentWillUnmount(){let{open:e,onClose:t}=this.props;e&&this.close(),t&&t(),document.removeEventListener("keydown",this.escFunction,!1)}render(){let{children:e}=this.props,{mounted:t}=this.state;return t&&"undefined"!=typeof document?l.createPortal(e,document.getElementById("portals")):null}constructor(...e){super(...e),this.state={mounted:!1},this.escFunction=e=>{let{onClose:t}=this.props;e.key&&"Escape"===e.key&&t&&t()},this.open=()=>{this.props.disableScrollFreeze||i.freeze()},this.close=()=>{this.props.disableScrollFreeze||i.unfreeze(),this.setState({mounted:!1})}}}},84449:function(e,t,a){"use strict";a.d(t,{y:function(){return h},Z:function(){return g}});var s=a(85893),l=a(67294),o=a(33362),n=a(93967),i=a.n(n),r=a(64989),c=a.n(r),u=a(65533);let d=l.forwardRef((e,t)=>{let{value:a,placeholder:l,disabled:o,onClick:n,isOpen:r,className:d}=e;return(0,s.jsxs)("div",{ref:t,className:i()(c().buttonWrap,d,{[c().disabled]:o,[c().isOpen]:r}),onClick:n,children:[a||l,(0,s.jsx)("div",{className:i()(c().buttonIcon,{[c().opened]:r}),children:(0,s.jsx)(u.Z,{name:"ic_16_arrow_fill_down"})})]})});d.displayName="OptionButton";var h=d,p=a(51526),m=a(11610);let v=e=>{let{list:t,selectedItem:a,onSelected:n,trigger:r,disabled:d,overflowContainer:h=!1,maxHeight:v,className:g,title:y}=e,[_,x]=(0,l.useState)(!1),f=l.cloneElement(r,{disabled:d,isOpen:_}),b=(0,l.useCallback)(e=>()=>{e.onClick&&e.onClick(e),e.onClick||e.href||!n||n(e)},[n]),w=(0,l.useCallback)(e=>()=>{d||x(e)},[d]);return(0,s.jsx)(p.M,{children:(0,s.jsx)(o.C,{trigger:f,overflowContainer:h||!1,disabled:d||!1,onOpen:w(!0),onClose:w(!1),isOpen:_,placement:"bottom-start",children:(0,s.jsx)(m.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:c().wrap,onMouseDown:e=>e.stopPropagation(),children:(0,s.jsxs)("div",{className:c().wrapper,children:[y&&(0,s.jsx)("div",{className:c().title,children:y}),(0,s.jsx)("div",{className:i()(c().content,g),style:{maxHeight:v?"".concat(v,"px"):"auto"},children:t.map(e=>{let t={key:e.id,onClick:b(e),className:i()(c().listItem,e.className,{[c().selected]:a===e.id})};return(0,s.jsxs)("div",{...t,children:[e.title,(0,s.jsx)("div",{className:c().icon,children:(0,s.jsx)(u.Z,{name:"ic_16_mark_done_fill"})})]},e.id)})})]})})})})};var g=v},57813:function(e,t,a){"use strict";var s=a(85893);a(67294);var l=a(42639),o=a.n(l),n=a(93967),i=a.n(n);let r=e=>{let{active:t,fill:a}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("svg",{className:i()(o().anim_24_sparks,{[o().active]:t}),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",width:24,height:24,fill:a||(t?"rgba(9, 9, 9, 1)":"#848484"),children:[(0,s.jsx)("path",{className:o()["anim_24_sparks-u-big"],d:"M13.5027,9.50272l1.5426-3.85633c.3447-.86185,1.5647-.86186,1.9094,0l1.5426,3.85633l3.8563,1.54258c.8619.3447.8619,1.5647,0,1.9094l-3.8563,1.5426-1.5426,3.8563c-.3447.8619-1.5647.8619-1.9094,0l-1.5426-3.8563-3.85631-1.5426c-.86185-.3447-.86186-1.5647,0-1.9094L13.5027,9.50272Z"}),(0,s.jsx)("path",{className:o()["anim_24_sparks-u-6"],d:"M19.9297,19.9297l.6611-1.6527c.1478-.3693.6706-.3693.8184,0l.6611,1.6527l1.6527.6611c.3693.1478.3693.6706,0,.8184l-1.6527.6611-.6611,1.6527c-.1478.3693-.6706.3693-.8184,0l-.6611-1.6527-1.6527-.6611c-.3693-.1478-.3693-.6706,0-.8184l1.6527-.6611Z",opacity:"0"}),(0,s.jsx)("path",{className:o()["anim_24_sparks-u-5"],d:"M9.92974,1.92974l.66106-1.652714c.1478-.369367.6706-.369368.8184-.000001l.6611,1.652715l1.6527.66108c.3693.14775.3693.67061,0,.81836l-1.6527.66108-.6611,1.65271c-.1478.36937-.6706.36937-.8184,0L9.92974,4.07026L8.27703,3.40918c-.36937-.14775-.36937-.67061,0-.81836l1.65271-.66108Z",opacity:"0"}),(0,s.jsx)("path",{className:o()["anim_24_sparks-u-4"],d:"M1.92974,11.9297l.66108-1.6527c.14775-.36934.67061-.36934.81836,0l.66108,1.6527l1.65271.6611c.36937.1478.36937.6706,0,.8184l-1.65271.6611-.66108,1.6527c-.14775.3693-.67061.3693-.81836,0l-.66108-1.6527-1.652714-.6611c-.369367-.1478-.369368-.6706-.000001-.8184l1.652715-.6611Z",opacity:"0"}),(0,s.jsx)("path",{className:o()["anim_24_sparks-u-3"],d:"M19.9297,1.92974l.6611-1.652714c.1478-.369367.6706-.369368.8184-.000001l.6611,1.652715l1.6527.66108c.3693.14775.3693.67061,0,.81836l-1.6527.66108-.6611,1.65271c-.1478.36937-.6706.36937-.8184,0l-.6611-1.65271-1.6527-.66108c-.3693-.14775-.3693-.67061,0-.81836l1.6527-.66108Z",opacity:"0"}),(0,s.jsx)("path",{className:o()["anim_24_sparks-u-2"],d:"M6.59082,16.277l-.66108,1.6527-1.65271.6611c-.36937.1478-.36937.6706,0,.8184l1.65271.6611.66108,1.6527c.14775.3693.67061.3693.81836,0l.66108-1.6527l1.65271-.6611c.36933-.1478.36933-.6706,0-.8184l-1.65271-.6611-.66108-1.6527c-.14775-.3693-.67061-.3693-.81836,0Z"}),(0,s.jsx)("path",{className:o()["anim_24_sparks-u-1"],d:"M3.92974,3.92974l.66108-1.65271c.14775-.36937.67061-.36937.81836,0l.66108,1.65271l1.65271.66108c.36937.14775.36937.67061,0,.81836l-1.65271.66108-.66108,1.65271c-.14775.36937-.67061.36937-.81836,0L3.92974,6.07026L2.27703,5.40918c-.36937-.14775-.36937-.67061,0-.81836l1.65271-.66108Z"})]})})};t.Z=r},3171:function(e,t,a){"use strict";var s=a(85893);a(67294);var l=a(93967),o=a.n(l),n=a(70124),i=a(86779),r=a.n(i);let c=e=>{let{text:t,className:a,...l}=e;return(0,s.jsx)(n.Z,{...l,text:t,className:o()(r().root,a)})};t.Z=c},65627:function(e,t,a){"use strict";var s=a(85893);a(67294);var l=a(70124),o=a(93967),n=a.n(o),i=a(28464),r=a.n(i);let c=e=>{let{text:t,className:a}=e;return(0,s.jsx)(l.Z,{text:t,className:n()(r().root,a)})};t.Z=c},70540:function(e,t,a){"use strict";var s=a(85893);a(67294);var l=a(93967),o=a.n(l),n=a(70124),i=a(34674),r=a.n(i);let c=e=>{let{text:t,className:a,html:l}=e;return(0,s.jsx)(n.Z,{text:t,html:l,className:o()(r().root,a)})};t.Z=c},33607:function(e,t,a){"use strict";var s=a(85893);a(67294);var l=a(93967),o=a.n(l),n=a(70124),i=a(10857),r=a.n(i);let c=e=>{let{text:t,className:a,...l}=e;return(0,s.jsx)(n.Z,{...l,text:t,className:o()(r().root,a)})};t.Z=c},66438:function(e,t,a){"use strict";a.r(t),a.d(t,{__N_SSP:function(){return a$},default:function(){return aV}});var s,l,o=a(85893),n=a(67294),i=a(86389),r=a(5152),c=a.n(r);let u=e=>(0,o.jsx)(n.Fragment,{children:e.children});var d=c()(()=>Promise.resolve(u),{ssr:!1}),h=a(50325),p=a(91792),m=a(32237),v=a(93967),g=a.n(v),y=a(63279),_=a(78940),x=a(98116);let f=(0,x.MT)({width:0,height:0}),b=(0,x.yM)();f.on(b,()=>({width:window.innerWidth-108,height:window.innerHeight-16}));let w=()=>{b()};window.addEventListener("resize",w);let D=()=>{let{commonLayout:e,scale:{value:t},position:{x:a,y:s},windowSize:{width:l,height:i}}=(0,y.useUnit)({commonLayout:_.CR,scale:_.$C,position:_.T9,windowSize:f}),{gapSize:r,gridLineSize:c}=e,[u,d]=(0,n.useMemo)(()=>Math.round(100*t)/100>0?[Array(Math.round(l/e.gapSize/t)).fill(""),Array(Math.round(i/e.gapSize/t)).fill("")]:[[],[]],[e.gapSize,i,t,l]),h=(0,n.useMemo)(()=>{if(!l||l<=0||t<.2)return[];let e=[];for(let l=0;l<u.length+2;l++)e.push((0,o.jsx)(m.x1,{lineCap:"round",lineJoin:"round",points:[l*r+a/t%r,s/t%r-400,l*r+a/t%r,(i+300+s/t%r)/t],stroke:"rgba(255, 255, 255, 0.1)",hitStrokeWidth:0,shadowForStrokeEnabled:!1,strokeWidth:c,listening:!1,shadowEnabled:!1,perfectDrawEnabled:!1},"horizontal-".concat(l)));for(let n=0;n<d.length+2;n++)e.push((0,o.jsx)(m.x1,{lineCap:"round",lineJoin:"round",points:[a/t%r-400,n*r+s/t%r,(l+300+a/t%r)/t,n*r+s/t%r],stroke:"rgba(255, 255, 255, 0.1)",hitStrokeWidth:0,shadowForStrokeEnabled:!1,strokeWidth:c,listening:!1,shadowEnabled:!1,perfectDrawEnabled:!1},"vertical-".concat(n)));return e},[l,t,u.length,r,a,s,i,c,d.length]);return(0,o.jsx)(o.Fragment,{children:h})};var j=a(4190),k=a(51241);let C=(e,t)=>{let a=Math.pow(10,t||0);return Math.round(e*a)/a},M=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_.$C.getState().value,l=window.innerWidth/2,o=window.innerHeight/2,n={x:(l-t)/s,y:(o-a)/s};return{x:l-n.x*e,y:o-n.y*e}},E=e=>{let t=0,a=0;return e.value=1,window.innerWidth>1600?(t=.3,a=.1):window.innerWidth>1400?(t=.3,a=.3):window.innerWidth>1024?(t=.3,a=.4):window.innerWidth<1024&&window.innerWidth>768?(t=.5,a=.1):(t=.6,a=.1),{value:C(e.value-t-a,1),downscaleCoefficient:t}},P=(e,t)=>{let{x:a,y:s}=t;return{x:a,y:s}},I=(e,t)=>({...e,value:t}),F=e=>{let[t,{value:a},s,l,o,n]=e,i=3/a,r=86/a,c=null==t?void 0:t.getSize(),u=l.height*a,d=l.width*a,h=o.y*a+n.y,p=o.x*a+n.x,m={...s};if(l&&o&&c){let e=p/a,t=h/a,s=u/a,l=d/a,o=c.height/a,n=c.width/a,v=c.width-p,g=c.height-h,y=u>0&&u+h<52,_=u>0&&g<0,x=d>0&&d+p<0,f=d>0&&v<0;x&&y?m.cornerPosition=[0/a,28/a,8/a,8/a,28/a,0]:x&&_?m.cornerPosition=[0,o-28/a,8/a,o-8/a,28/a,o]:f&&y?m.cornerPosition=[n-4/a,28/a,n-9/a,9/a,n-28/a,0/a]:f&&_?m.cornerPosition=[n,o-48/a,n-9/a,o-9/a,n-48/a,o+2/a]:m.cornerPosition=null,m.spotLightsPosition=[{id:"left",isVisible:x,gradient:[0,y?"#D3FD7A":"rgba(211, 253, 122, 0)",.5,"#D3FD7A",1,_?"#D3FD7A":"rgba(211, 253, 122, 0)"],shape:{x:0,y:Math.min(Math.max(0/a,t+s/2-r/2),o-r),height:r,width:i}},{id:"bottom",isVisible:_,gradient:[0,x?"#D3FD7A":"rgba(211, 253, 122, 0)",.5,"#D3FD7A",1,f?"#D3FD7A":"rgba(211, 253, 122, 0)"],shape:{x:Math.min(Math.max(0,e+l/2-r/2),n-r),y:o-i-2/a,height:i,width:r}},{id:"right",isVisible:f,gradient:[0,y?"#D3FD7A":"rgba(211, 253, 122, 0)",.5,"#D3FD7A",1,_?"#D3FD7A":"rgba(211, 253, 122, 0)"],shape:{x:n-i-2/a,y:Math.min(Math.max(0/a,t+s/2-r/2),o-r),height:r,width:i}},{id:"top",isVisible:y,gradient:[0,x?"#D3FD7A":"rgba(211, 253, 122, 0)",.5,"#D3FD7A",1,f?"#D3FD7A":"rgba(211, 253, 122, 0)"],shape:{x:Math.min(Math.max(0,e+l/2-r/2),n-r),y:0/a,height:i,width:r}}]}return m};var S=a(74738),R=a(93240);let N=(0,x.yM)(),L=(0,x.yM)(),Z=(0,x.yM)(),A=(0,x.yM)(),T=(0,x.$e)(_.Iq,e=>!e.spotLightsPosition.some(e=>e.isVisible));_.$C.on(N,E),_.$C.on(A,I),_.T9.on(L,P),_.KN.on(Z,()=>!0),(0,x.UP)({clock:[_.$C,_.T9],source:[R.xD,_.$C,_.Iq,S.RR,S.YG,_.T9],fn:F,target:_.Iq}),(0,x.UP)({clock:_.$C,source:[S.RR,S.YG,_.$C],fn:e=>{let[t]=e;return t}});var z=a(21247),Y=(e,t,a,s)=>{let l=Math.min(1024,e>t?e:t);if(a===s)return{width:l,height:l};if(a>s){let e=s/a,t=l*e-l*e%4;return t<128?{height:l,width:l/e-l/e%4}:{height:t,width:l}}{let e=a/s,t=l*e-l*e%4;return t<128?{height:l/e-l/e%4,width:l}:{height:l,width:t}}};let G=(e,t)=>Math.round(e/t)*t,B=e=>{let[t,a,s,l]=e,o=s.x*t.value,n=l.width-(s.x*t.value+a.width*t.value),i=s.y*t.value,r=l.height-(s.y*t.value+a.height*t.value);return{x:(n-o)/2,y:(r-i)/2}},O=(e,t)=>{let[a,s,l]=e,o=t||s;if(a.width&&a.height){let e=Y(a.width,a.height,o[0],o[1]),t=l.x+(a.width-e.width)/2;try{localStorage.setItem("fb-ratio",JSON.stringify(o))}catch(e){console.error("failed to save ratio")}return{eyeRatio:o,eyePosition:{x:t,y:l.y},eyeSize:e}}return{eyeRatio:o,eyePosition:{x:l.x,y:l.y},eyeSize:a}},U=e=>{let[t,a,s]=e,l=M(t.value,0,0,1);return{eyeSize:{width:a.width,height:a.height},eyePosition:{x:G(window.innerWidth/2-a.width/2+l.x/t.value,s.gapSize),y:G(window.innerHeight/2-a.width/2+l.y/t.value,s.gapSize)}}},$=e=>{let[t,a,s,l]=e;return{width:t.width*s.value,height:t.height*s.value,x:a.x*s.value+l.x,y:a.y*s.value+l.y}},V=(e,t)=>t;var W=a(22523),H=a(76830);let q=(0,x.yM)(),X=(0,x.yM)(),K=(0,x.yM)(),J=(0,x.yM)(),Q=(0,x.yM)(),ee=(0,x.yM)(),et=(0,x.yM)(),ea=(0,x.yM)(),es=(0,x.yM)(),el=(0,x.yM)(),eo=(0,H.D)(es,200),en=(0,x.yM)(),ei=(0,x.yM)(),er=(0,H.D)(en,10),ec=(0,H.D)(ei,200);(0,x.UP)({clock:ec,target:S.z_,fn:()=>!1}),(0,x.UP)({clock:er,target:S.z_,fn:()=>!0}),(0,x.UP)({clock:[_.T9],target:[es,el]}),(0,x.UP)({clock:eo,fn:()=>!0,target:S.vd}),(0,x.UP)({clock:el,fn:()=>!1,target:S.vd}),S.YG.on(q,V),S.RR.on(X,V),(0,x.UP)({clock:Q,source:[S.RR,S.lF,S.YG],fn:O,target:(0,z.h)({eyeRatio:S.lF,eyePosition:S.YG,eyeSize:S.RR})}),(0,x.UP)({clock:J,source:[_.$C,S.RR,S.YG,f],fn:B,target:_.T9}),(0,x.UP)({clock:ee,source:[_.$C,S.RR,_.CR],fn:U,target:(0,z.h)({eyeSize:S.RR,eyePosition:S.YG})}),(0,x.UP)({clock:et,source:[S.RR,S.YG],target:(0,z.h)({eyeSize:S.RR,eyePosition:S.YG}),fn:(e,t)=>{let[a,s]=e;return{eyeSize:{width:t.width||a.width,height:t.height||a.height},eyePosition:{x:t.x||s.x,y:t.y||s.y}}}}),(0,x.UP)({clock:[S.RR,S.YG,_.$C,_.T9,S.lF],source:[S.RR,S.YG,_.$C,_.T9],target:S.pN,fn:$}),(0,x.UP)({clock:ea,source:R.iL,target:S.pN,fn:e=>e.getClientRect()}),(0,x.UP)({clock:[S.YG,S.RR],target:(0,z.h)({previousFile:W.KR,previousId:W.YP}),fn:()=>({previousFile:null,previousId:null})}),(0,x.UP)({clock:K,source:[S.RR,S.YG],target:(0,z.h)({eyeSize:S.RR,eyePosition:S.YG,ratio:S.lF}),fn:(e,t)=>{let[a,s]=e,l=Y(a.width,a.height,t[0],t[1]),o=s.x+(a.width-l.width)/2;try{localStorage.setItem("fb-ratio",JSON.stringify(t))}catch(e){console.error("failed to save ratio")}return{eyeSize:l,eyePosition:{...s,x:o},ratio:t}}}),S.lF.on(K,V);let eu=e=>{let{isShowed:t}=e,{spotlight:a,scale:{value:s},toggleSelectHoverState:l,selectInView:i,moveToCenter:r}=(0,j.eY)({spotlight:_.Iq,scale:_.$C,toggleSelectHoverState:k.Gc,selectInView:T,moveToCenter:J}),c=(0,n.useCallback)(()=>{r()},[r]),u=(0,n.useCallback)(()=>{l(!0)},[l]),d=(0,n.useCallback)(()=>{l(!1)},[l]);(0,n.useEffect)(()=>{i&&l(!1)},[i,l]);let h=(0,n.useMemo)(()=>a.spotLightsPosition.map(e=>e.isVisible?(0,o.jsx)(m.UL,{...e.shape,fillLinearGradientStartPoint:{x:0,y:0},fillLinearGradientEndPoint:{x:e.shape.width,y:e.shape.height},fillLinearGradientColorStops:e.gradient,onClick:c,onMouseEnter:u,onMouseLeave:d},e.id):null),[u,d,c,a.spotLightsPosition]);return t?(0,o.jsxs)(o.Fragment,{children:[a.cornerPosition&&(0,o.jsx)(m.x1,{onClick:c,onMouseEnter:u,onMouseLeave:d,points:a.cornerPosition,stroke:"#D3FD7A",strokeWidth:3/s,lineJoin:"round",lineCap:"round",tension:.5}),h]}):null};var ed=a(24851),eh=a(28660),ep=a(84898);let em=(e,t)=>{let[a,s,l]=e,o=l[t],n=s.reduce((e,t)=>o.groupId===t?e:[...e,t],[]);return{objects:[...a,t],groups:n,openedLayers:{id:o.groupId,state:!0}}},ev=(e,t)=>{let a=e.findIndex(e=>e===t);return a>=0?e.filter(e=>e!==t):e},eg=(e,t)=>{let[a,s,l]=e,o=l.find(e=>e.id===t),n=a.reduce((e,t)=>o.objects.includes(t)?e:[...e,t],[]);return{groups:[...s,t],objects:n}},ey=(e,t)=>{let a=e.findIndex(e=>e===t);return a>=0?e.filter(e=>e!==t):e},e_=()=>({groups:[],objects:[]}),ex=e=>{let[t,a,s,l,o]=e,n=o.findOne("#selected-group-view"),i=n.getClientRect({relativeTo:l}),r=i.height*t.value,c=i.width*t.value,u=t.value;(0,ep.F)("center");let d=s.height/s.width;(r>s.height||c>s.width)&&(u=r/c<d?t.value*(s.width-300)/c:t.value*(s.height-300)/r);let h=Math.max(Math.min(u,1.5),.1),p=i.x*h,m=s.width-(i.x*h+i.width*h),v=(m-p)/2,g=i.y*h,y=s.height-(i.y*h+i.height*h),_=(y-g)/2,x=(0-v)/u+s.width/u/2-a.width/2,f=(0-_)/u+s.height/u/2-a.height/2;return{position:{x:v,y:_},scale:{...t,value:h},eyePosition:{x:x,y:f}}},ef=e=>{let[t,a,s,l]=e,o=a.findOne("#selected-group-view"),n=o?o.getClientRect({relativeTo:t}):null;return n?{width:n.width*l.value,height:n.height*l.value,x:n.x*l.value+s.x,y:n.y*l.value+s.y}:null};var eb=a(71168);let ew=(0,x.yM)(),eD=(0,x.yM)(),ej=(0,x.yM)(),ek=(0,x.yM)(),eC=(0,x.yM)(),eM=(0,x.$e)(eh.J1,eh.d1,(e,t)=>e.length>0||t.length>0),eE=(0,x.yM)(),eP=(0,x.yM)();(0,x.UP)({clock:[eb.X9,A,J,eb.z2,eb.FB,_.T9,_.$C],source:[eh.J1,eh.d1],filter:(e,t)=>e.length>0||t.length>0,target:eP}),(0,x.UP)({clock:eP,source:[R.xD,R.V6,_.T9,_.$C],target:eh.Dx,fn:ef}),(0,x.UP)({clock:[eC,eb.tG],target:(0,z.h)({objects:eh.J1,groups:eh.d1}),fn:e_}),(0,x.UP)({clock:ew,target:(0,z.h)({objects:eh.J1,groups:eh.d1,openedLayers:k.sN}),source:[eh.J1,eh.d1,W.hZ],fn:em}),(0,x.UP)({clock:eD,target:eh.J1,source:eh.J1,fn:ev}),(0,x.UP)({clock:ej,target:(0,z.h)({objects:eh.J1,groups:eh.d1}),source:[eh.J1,eh.d1,W.RH],fn:eg}),(0,x.UP)({clock:ek,target:eh.d1,source:eh.d1,fn:ey}),(0,x.UP)({clock:eE,source:[_.$C,S.RR,f,R.xD,R.V6],fn:ex,target:(0,z.h)({position:_.T9,scale:_.$C,eyePosition:S.YG})});var eI=a(45877);let eF=(0,x.yM)(),eS=(0,x.yM)(),eR=(0,x.yM)(),eN=(0,x.MT)(!1),eL=(0,x.MT)(!1),eZ=(0,x.MT)(!1);eN.on([eF,eS],(e,t)=>t.shiftKey),eL.on([eF,eS],(e,t)=>t.ctrlKey||t.metaKey),eZ.on([eF,eS],(e,t)=>t.altKey),"undefined"!=typeof document&&(document.addEventListener("keyup",e=>eF(e)),document.addEventListener("keydown",e=>eS(e)),document.addEventListener("keypress",e=>eR(e)));let eA=()=>{let{activeStateValue:{isEraserActive:e},addSelection:t,removeSelection:a,addSelectionGroup:s,removeSelectionGroup:l,clearSelection:o,imagePreview:i,objects:r,list:c,eyeMovingStop:u,eyeMovingStart:d,eyeIsMoving:h,isShiftDown:p,selected:m,selectedGroups:v,isMove:g,stageNodeRef:y}=(0,j.eY)({activeStateValue:ed.Mn,addSelection:ew,removeSelection:eD,addSelectionGroup:ej,removeSelectionGroup:ek,clearSelection:eC,imagePreview:W.IE,objects:W.hZ,list:W.RH,eyeMovingStart:en,eyeMovingStop:ei,eyeIsMoving:S.z_,isShiftDown:eN,selected:eh.J1,selectedGroups:eh.d1,preparingImg:k.s2,isMove:ed.uS,stageNodeRef:R.xD}),_=(0,n.useRef)(null),x=(0,n.useCallback)(()=>{if(y&&!i&&!h&&!e){let e=y.getRelativePointerPosition(),s=(0,eI.Yz)(r,c,{x:e.x-5,y:e.y-5,width:10,height:10});if(s&&s.length>0){let e=s[0].id;p?m.includes(e)?a(e):t(e):(o(),t(e))}else o()}},[t,o,h,i,e,p,c,r,a,m,y]),f=(0,n.useCallback)(()=>{!y||i||h||e||g||(m.length>0&&p?x():_.current?(clearTimeout(_.current),x(),_.current=null):_.current=setTimeout(()=>{let e=y.getRelativePointerPosition(),a=(0,eI.Yz)(r,c,{x:e.x-5,y:e.y-5,width:10,height:10}),n=a&&a.length>0?a[0].groupId:null,i=null==c?void 0:c.find(e=>e.id===n);if(n){if(p)s(n);else if(o(),v.includes(n))l(n);else{var u;(null==i?void 0:null===(u=i.objects)||void 0===u?void 0:u.length)===1?t(i.objects[0]):s(n)}}else o();_.current=null},300))},[t,s,o,h,i,e,g,p,c,r,l,x,m.length,v,y]),b=(0,n.useCallback)(e=>{p?m.includes(e)?a(e):t(e):(o(),t(e))},[t,o,p,a,m]),w=(0,n.useCallback)(e=>{p?v.includes(e)?l(e):s(e):(o(),s(e))},[s,o,p,l,v]),D=(0,n.useCallback)(()=>{d()},[d]),C=(0,n.useCallback)(()=>{u()},[u]);return{onSelectMove:D,onSelectMoveStop:C,selectByClick:f,selectObjectInLayers:b,selectGroupInLayers:w}};var eT=a(31955),ez=a(11163),eY=a(10953);let eG=()=>{let{push:e}=(0,ez.useRouter)(),{startGeneration:t,updateText2ImageParams:a}=(0,j.eY)({startGeneration:eb.$A,updateText2ImageParams:eY.CM}),s=(0,n.useCallback)(()=>{let s=new URLSearchParams(window.location.search),l=s.get("qtg");l&&eT.Z.get("fb-cookies-accept")&&localStorage.getItem("fb-rules-accept")&&(a({generateParams:{query:l}}),t(),(0,ep.F)("9may"),e("".concat(location.pathname)))},[e,t,a]);return(0,n.useEffect)(()=>{setTimeout(()=>{s()},100)},[s]),{checkQueryToGenerate:s}};var eB=a(20185),eO=a.n(eB);let eU=e=>{let{width:t=1024,height:a=1024,y:s=0,x:l=0}=e,i=(0,n.useRef)(null),{scale:{value:r}}=(0,j.eY)({scale:_.$C}),c=(0,n.useCallback)(()=>{if(i.current){let e=[],s=0,l=500*r,o=i.current,n=()=>{s<1&&(s+=.01,o&&o.opacity(Math.min(1,s)));for(let s=0;s<e.length;s++){let l=e[s];l.op>1?l.factor=-1:l.op<=0&&(l.factor=1,l.position({x:Math.round(Math.random()*t),y:Math.round(Math.random()*a)})),l.op=Math.max(0,l.op+l.increment*l.factor),l.opacity(l.op)}requestAnimationFrame(n)};window.requestAnimationFrame(n),(()=>{o.find("Star").forEach(e=>e.destroy());for(let s=0;s<l;s++){let s=Math.random(),l=new(eO()).Star({x:Math.round(Math.random()*t),y:Math.round(Math.random()*a),opacity:s,numPoints:4,innerRadius:1+2*Math.random(),outerRadius:1+4*Math.random(),fill:"rgba(255,255,255, 1)",transformsEnabled:"position",perfectDrawEnabled:!1,shadowEnabled:!1});l.op=s,l.length=1+Math.random(),l.factor=.5,l.increment=.08*Math.random(),e.push(l),o&&o.add(l)}})()}},[a,r,t]);return(0,n.useEffect)(()=>{c()},[c]),(0,o.jsxs)(m.ZA,{opacity:0,ref:i,listening:!1,width:t||0,height:a||0,x:l||0,y:s||0,name:"object-loader",children:[(0,o.jsx)(m.UL,{opacity:.7,fill:"#090909",x:0,y:0,height:a||0,width:t||0,shadowColor:"rgba(0, 0, 0, 1)",listening:!1}),(0,o.jsx)(m.UL,{strokeWidth:1,stroke:"rgba(255, 255, 255, 1)",opacity:.7,x:0,y:0,height:a||0,width:t||0,shadowColor:"rgba(0, 0, 0, 1)",globalCompositeOperation:"overlay",listening:!1})]})};var e$=a(75185);let eV=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,eW=(e,t,a)=>{let[s,l]=(0,n.useState)(!1),[o,i]=(0,n.useState)(null),r=(0,n.useCallback)(async()=>{l(!0);let{data:t}=await (0,e$.Z)({url:e,method:"GET",responseType:"blob"});return l(!1),t},[e]),c=(0,n.useCallback)(async()=>{let s=new Image;if(t)s.src=t;else if(eV.test(e)||e.includes("data:image"))s.src=e.includes("data:image")?e:"data:image/png;base64,".concat(e);else{let e=window.URL||window.webkitURL,t=await r();s.src=e.createObjectURL(t),e.revokeObjectURL(t)}null==a||a(s.src),i(s)},[t,r,a,e]);return(0,n.useEffect)(()=>{(e||t)&&c()},[t,c,e]),{isLoading:s,image:o}};var eH=a(71863);let eq=e=>{let{object:{isLoading:t,imageUrl:a,id:s,shape:l,imageId:i,groupId:r},forEraser:c}=e,u=n.useRef(null),{setImageFileFn:d,files:h,ePath:p,selected:v,selectedGroups:g}=(0,j.eY)({setImageFileFn:eb.T2,files:W.lP,ePath:eH.w,selected:eh.J1,selectedGroups:eh.d1}),y=(0,n.useMemo)(()=>h[i],[h,i]),_=(0,n.useCallback)(e=>{d({id:s,file:e})},[s,d]),{isLoading:x,image:f}=eW(a,y,_),b=(0,n.useMemo)(()=>!(null==v?void 0:v.length)&&!(null==g?void 0:g.length)||v.includes(s)||g.includes(r),[r,s,v,g]);return(0,n.useMemo)(()=>{var e,a;return(0,o.jsxs)(m.ZA,{id:"image-object-".concat(c?"eraser":"","-").concat(s),children:[f&&!x&&(0,o.jsx)(m.Ee,{id:s,...l,image:f,name:b?"stickyObject":"object stickyObject",perfectDrawEnabled:!1,shadowEnabled:!1,listening:!1,ref:u}),(null==p?void 0:p.path)&&(null==p?void 0:null===(e=p.path)||void 0===e?void 0:e.length)!==0&&b&&(0,o.jsx)(m.ZA,{clipY:null==l?void 0:l.y,clipX:null==l?void 0:l.x,clipHeight:null==l?void 0:l.height,clipWidth:null==l?void 0:l.width,children:(0,o.jsx)(m.x1,{hitStrokeWidth:0,shadowForStrokeEnabled:!1,stroke:c?"blue":"#D3FD7A",opacity:c?1:.4,strokeWidth:(null==p?void 0:p.width)*10,lineCap:"round",lineJoin:"round",listening:!1,shadowEnabled:!1,perfectDrawEnabled:!1,points:(null==p?void 0:null===(a=p.path)||void 0===a?void 0:a.length)!==0?null==p?void 0:p.path:[],globalCompositeOperation:c?"destination-out":"difference"})}),(t||x)&&(0,o.jsx)(eU,{...l})]})},[null==p?void 0:p.path,null==p?void 0:p.width,c,s,f,t,b,x,l])},eX=e=>{let{group:t}=e,{objects:a}=(0,j.eY)({objects:W.hZ}),s=(0,n.useMemo)(()=>{var e,s,l;return null===(e=null===(s=null===(l=t.objects)||void 0===l?void 0:l.filter(e=>e))||void 0===s?void 0:s.reverse())||void 0===e?void 0:e.map(e=>{let t=a[e];return t?(0,o.jsx)(eq,{object:t},null==t?void 0:t.id):null})},[t.objects,a]);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(m.ZA,{listening:!1,shadowEnabled:!1,perfectDrawEnabled:!1,id:t.id,name:"objectGroup",children:s})})};var eK=a(20093);let eJ=e=>{let{forEraser:t=!1}=e,{list:a,objects:s,eraserIntersectObjects:l}=(0,j.eY)({list:W.RH,objects:W.hZ,erasePath:eH.w,eraserIntersectObjects:eK.bh}),i=(0,n.useMemo)(()=>{var e,s;return t?null:null===(e=null===(s=null==a?void 0:a.filter(e=>e))||void 0===s?void 0:s.reverse())||void 0===e?void 0:e.map(e=>(0,o.jsx)(eX,{group:e},e.id))},[t,a]),r=(0,n.useMemo)(()=>{var e;return null===(e=Object.values(s))||void 0===e?void 0:e.map(e=>{if(e.isLoading)return(0,o.jsx)(m.ZA,{shadowEnabled:!1,perfectDrawEnabled:!1,listening:!1,children:(0,o.jsx)(eq,{object:e},e.id)},e.id)})},[s]),c=(0,n.useMemo)(()=>null==l?void 0:l.map(e=>(0,o.jsx)(eq,{forEraser:!0,object:e},e.id)),[l]);return t?(0,o.jsx)(o.Fragment,{children:c}):(0,o.jsxs)(o.Fragment,{children:[i,r]})};var eQ=a(65440);let e0=()=>{let[e,t]=(0,eQ.iP)();return[e-108,t-16]};var e1=a(18536),e3=a.n(e1),e2=a(65533),e6=a(76269),e8=a.n(e6),e5=a(62372),e4=()=>{let e=(0,eQ.Lm)(),t=(0,n.useMemo)(()=>{let e="undefined"!=typeof navigator&&(navigator.userAgent||navigator.vendor);return/apple/gi.test(e)&&!/windows/gi.test(e)},[]),a=(0,n.useMemo)(()=>{let t="undefined"!=typeof navigator&&(navigator.userAgent||navigator.vendor||window.opera);return t&&(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t.substr(0,4))||/iPad/gi.test(t))||e<1240},[e]),s=(0,n.useMemo)(()=>e>1024,[e]),l=(0,n.useMemo)(()=>e<1024&&e>750||a,[a,e]),o=(0,n.useMemo)(()=>e<750||a,[a,e]);return{isDesktop:s,isMobile:o,isTablet:l,isMobileDeviceUserAgent:a,isIos:t}};let e7=e=>{let{children:t,className:a,active:s,tooltip:l,tip:i,hovered:r=!0,...c}=e,[u,d]=(0,n.useState)(!1),{isMobile:h,isTablet:p,isMobileDeviceUserAgent:m}=e4(),{renderLayer:v,triggerProps:y,layerProps:_,arrowProps:x}=(0,e5.sJ)({isOpen:Boolean(u&&(l||i)&&!h&&!p),placement:"bottom-center",auto:!0,possiblePlacements:["bottom-center","top-center"],preferY:"bottom",triggerOffset:16,container:document.getElementById("app-container")}),f=(0,n.useCallback)(e=>()=>{d(e)},[]);return(0,o.jsxs)("button",{...y,className:g()(e8().root,a,{[e8().active]:s,[e8().hovered]:r}),...c,onMouseEnter:f(!0),onMouseLeave:f(!1),children:[u&&(l||i)&&!h&&!p&&!m&&v((0,o.jsxs)("div",{className:e8().tooltip,..._,children:[(0,o.jsxs)("div",{className:e8().tip,children:[l&&(0,o.jsx)("span",{className:e8().tipMain,children:l}),i&&(0,o.jsx)("span",{className:e8().tipSecond,children:i})]}),(0,o.jsx)(e5.Eh,{...x,backgroundColor:"#303030",size:8})]})),t]})};var e9=a(4374),te=a(84449);let tt=()=>{let{scale:e,setScale:t,stageNodeRef:a,setPosition:s}=(0,j.eY)({scale:_.$C,setScale:A,setPosition:L,stageNodeRef:R.xD}),l=(0,n.useMemo)(()=>Math.round((e.value+e.downscaleCoefficient)*100),[e.downscaleCoefficient,e.value]),i=(0,n.useCallback)(l=>{let{value:o}=l,n=Math.max(Math.min(o-100*e.downscaleCoefficient,150),10)/100;if(a){let e=M(n,a.x(),a.y());a.scale({x:n,y:n}),a.position(e),s(e),t(n)}},[a,e.downscaleCoefficient,s,t]),r=(0,n.useMemo)(()=>[{id:1,title:"180%",value:180},{id:2,title:"150%",value:150},{id:3,title:"100%",value:100},{id:4,title:"40%",value:40}],[]);return(0,o.jsx)(te.Z,{onSelected:i,list:r,trigger:(0,o.jsx)(te.y,{className:e3().optionButton,placeholder:"",value:"".concat(l,"%")}),maxHeight:400})};var ta=a(89667),ts=a(93463),tl=a(85529),to=a.n(tl);(s=l||(l={})).generate="generate",s.erase="erase",s.imagePreview="imagePreview";var tn=a(69801),ti=a(73934),tr=a(29613),tc=a(60855),tu=a(17796);let td=(0,x.yM)(),th=(0,x.yM)(),tp=(0,tu.fi)({source:{objects:W.hZ,list:W.RH,position:_.T9,scale:_.$C,eyePosition:S.YG,eyeSize:S.RR,eyeIsMoving:S.z_,eyeRatio:S.lF,objectsCount:W.V9},clock:[eb._7,Z,eb.p0],maxLength:35});(0,x.UP)({clock:td,target:tp.undo}),(0,x.UP)({clock:th,target:tp.redo}),(0,x.UP)({clock:tp.$history,source:[W.lP,W.RH,W.hZ,tp.$history],target:W.lP,fn:e=>{var t;let[a,s,l,o]=e,n={},i={...a};return null==s||s.forEach(e=>{n[e.preview]=!0}),null===(t=null==Object?void 0:Object.values(l))||void 0===t||t.forEach(e=>{n[e.imageId]=!0}),o.forEach(e=>{var t,a;null===(t=null==Object?void 0:Object.values(null==e?void 0:e.objects))||void 0===t||t.forEach(e=>{n[e.imageId]=!0}),null==e||null===(a=e.list)||void 0===a||a.forEach(e=>{n[e.preview]=!0})}),Object.keys(i).forEach(e=>{n[e]||delete i[e]}),i}});var tm=a(28458);let tv=()=>{var e,t;let{t:a}=(0,e9.$)(),{isOnline:s}=(0,ti.Z)(),{preparingImg:o,scale:{value:i},startImagePreviewInsert:r,position:c,activeStateValue:{isImagePreviewActive:u,isGenerateActive:d,isEraserActive:h},imagePreview:p,textToImageModelParams:m,hasIntersect:v,historyUndo:g,historyRedo:y,setActiveState:x,isModelAvailable:f,addNotification:b,selectedExist:w,saveAll:D,saveSelected:C,toggleEraser:M,stageNodeRef:E,moveSelectedToCenter:P,deleteSelected:I,duplicateSelected:F,removeNotification:S}=(0,j.eY)({preparingImg:k.s2,scale:_.$C,startImagePreviewInsert:eb.CS,position:_.T9,activeStateValue:ed.Mn,imagePreview:W.IE,textToImageModelParams:tc.R4,previousGeneratedObjectId:W.YP,hasIntersect:W.O1,historyUndo:td,historyRedo:th,setActiveState:k.k$,isModelAvailable:ed.hV,addNotification:tm.Mw,selectedExist:eM,saveAll:eb.Y_,saveSelected:eb.kz,toggleEraser:k.fp,stageNodeRef:R.xD,moveSelectedToCenter:eE,deleteSelected:eb.tG,duplicateSelected:eb.X7,removeNotification:tm.S6}),N=(0,n.useCallback)(e=>()=>{e===l.erase?(w?M():x(e),(0,ep.F)("erasebyclick")):x(e)},[w,x,M]),L=(0,n.useMemo)(()=>h,[h]),Z=(0,n.useMemo)(()=>Boolean(o)||!s,[s,o]),A=(0,n.useCallback)(e=>{var t,s;let o=null===(t=e.target)||void 0===t?void 0:null===(s=t.files)||void 0===s?void 0:s[0];if(!o.type.match(/image\/(png|jpeg)/))return b({message:a("errors.fileFormat"),type:tr.Pu.ERROR,closable:!1});if(o&&E){let t=window.URL||window.webkitURL,a=new Image,s=t.createObjectURL(o);a.onload=async function(){t.revokeObjectURL(s);let a=await (0,tn.pn)(o,this.width*i,this.height*i,E.width()-32,E.height()-128);r({type:"image",key:a.key,base64:a.base64,file:o,visible:!0,shapeProps:{x:(0-c.x+E.width()/2-a.width/2)/i,y:(0-c.y+E.height()/2-a.height/2)/i,width:a.width/i,height:a.height/i}}),x(l.generate),e.target.value="",e.target.blur()},a.src=s}},[E,b,a,i,r,c.x,c.y,x]),T=(0,n.useCallback)(()=>{x(l.generate),b({id:"downloadingHint",message:a("downloading"),closable:!1,timeout:0,withoutIcon:!0}),setTimeout(()=>{w?C():D(),S("downloadingHint")},100)},[b,S,D,C,w,x,a]),z=(0,n.useCallback)(()=>{g(),(0,ep.F)("backbyclick")},[g]),Y=(0,n.useCallback)(()=>{y(),(0,ep.F)("forwardbyclick")},[y]),G=(0,n.useCallback)(()=>{u||x(l.generate),(0,ep.F)("insertimagebybutton")},[u,x]),B=(0,n.useMemo)(()=>{var e,t,a;return Boolean(o)||!!p||!v&&!(null===(e=m.generateParams.query)||void 0===e?void 0:e.length)||Z||!f||(null===(t=m.negativePromptDecoder)||void 0===t?void 0:t.length)>1e3||(null===(a=m.generateParams.query)||void 0===a?void 0:a.length)>1e3},[o,p,v,null===(e=m.generateParams.query)||void 0===e?void 0:e.length,null===(t=m.negativePromptDecoder)||void 0===t?void 0:t.length,Z,f]),O=(0,n.useCallback)(()=>{x(l.generate),P()},[P,x]),U=(0,n.useCallback)(()=>{x(l.generate),I()},[I,x]),$=(0,n.useCallback)(()=>{x(l.generate),F()},[F,x]);return{toggleDownloadState:T,handleStateChange:N,handleFileChange:A,isInterfaceDisabled:Z,isGenerateActive:d,isEraseActiveState:L,isPromptDisabled:B,handleHistoryBack:z,handleHistoryForward:Y,handleInsertClick:G,moveSelectedToCenter:O,deleteSelected:U,duplicateSelected:$}};var tg=a(42708),ty=a(33362),t_=a(39474),tx=a(95298),tf=a(70540);let tb=e=>{let{placeholder:t,onChange:a,value:s,error:l,type:i}=e,{isInterfaceDisabled:r}=tv(),{t:c}=(0,tx.$G)(),{textToImageModelParams:u,updateText2ImageParams:d,moveToCenter:h,setInputIsInFocus:p,isSelectInView:m}=(0,j.eY)({textToImageModelParams:tc.R4,updateText2ImageParams:eY.CM,moveToCenter:J,setInputIsInFocus:k.VI,isSelectInView:T}),v=(0,n.useCallback)(()=>{let e=!u.censor.useGigaBeautificator;d({censor:{useGigaBeautificator:e}})},[u.censor.useGigaBeautificator,d]),y=(0,n.useCallback)(e=>t=>{!0!==e||m||h(),p(e),e&&setTimeout(function(){t.target.selectionStart=t.target.selectionEnd=1e4},0)},[m,h,p]),_=(0,n.useCallback)(e=>t=>{e||(h(),t.preventDefault()),"Escape"===t.key&&t.target.blur()},[h]),x=(0,n.useCallback)(e=>{e.stopPropagation()},[]);return(0,n.useEffect)(()=>{s&&0!==s.length||(document.getElementById("textAreaAutoFocus").value="")},[s]),(0,o.jsxs)("div",{className:to().textAreaWrap,onContextMenu:x,children:["prompt"===i&&(0,o.jsx)(ty.C,{trigger:(0,o.jsx)("div",{className:g()(to().infoIcon,{[to().active]:u.censor.useGigaBeautificator}),onClick:v,children:(0,o.jsx)(e2.Z,{name:"ic_16_magic_wand"})}),placement:"right-center",triggerOnHover:!0,children:(0,o.jsxs)(ty.Z,{className:to().artGptHint,children:[(0,o.jsx)(t_.Z,{text:"ArtGPT"}),(0,o.jsx)(t_.Z,{className:to().artGptToggle,text:c(u.censor.useGigaBeautificator?"artGptM1Off":"artGptM1On")}),(0,o.jsx)(tf.Z,{text:c("artGptM2")})]})}),(0,o.jsx)(tg.df,{threshold:.9,children:e=>{let{inView:n,ref:i}=e;return(0,o.jsx)(ts.Z,{ref:i,id:"textAreaAutoFocus",disabled:r,placeholder:t,maxLength:2e3,defaultValue:s,className:g()(to().textArea,"scrollbar-fb",{[to().error]:l}),onChange:a,onKeyDownCapture:_(n),onBlur:y(!1),onFocus:y(!0)})}})]})},tw=()=>{var e;let{textToImageModelParams:t,updateText2ImageParams:a}=(0,j.eY)({textToImageModelParams:tc.R4,updateText2ImageParams:eY.CM}),{t:s}=(0,e9.$)(),l=(0,n.useCallback)(e=>{a({negativePromptDecoder:e.target.value.replace(/^\s*/,"")})},[a]);return(0,o.jsx)(tb,{type:"negative",value:null==t?void 0:t.negativePromptDecoder,onChange:l,placeholder:s("negativePrompt"),error:(null==t?void 0:null===(e=t.negativePromptDecoder)||void 0===e?void 0:e.length)>1e3})},tD=()=>{let{textToImageModelParams:e,updateText2ImageParams:t}=(0,j.eY)({textToImageModelParams:tc.R4,updateText2ImageParams:eY.CM}),{t:a}=(0,e9.$)(),s=(0,n.useCallback)(e=>{t({generateParams:{query:e.target.value.replace(/^\s*/,"")}})},[t]);return(0,o.jsx)(tb,{type:"prompt",value:e.generateParams.query,onChange:s,placeholder:a("defaultPrompt2"),error:e.generateParams.query.length>1e3})};var tj=a(80556),tk=a.n(tj),tC=a(57813),tM=a(3171),tE=a(98315),tP=a.n(tE),tI=a(70124),tF=a(2485),tS=a.n(tF);let tR=e=>{let{text:t,className:a}=e;return(0,o.jsx)(tI.Z,{text:t,className:g()(tS().root,a)})};var tN=a(87428),tL=a(7550),tZ=a(99942);let tA=e=>{let{value:t}=e,{updateText2ImageParams:a,selectedStyle:s,stylesList:l}=(0,j.eY)({updateText2ImageParams:eY.CM,selectedStyle:tZ.k,stylesList:tc.lO}),{t:i}=(0,e9.$)(),{i18n:r}=(0,e9.$)(),c=(0,n.useMemo)(()=>(null==r?void 0:r.language.slice(0,2))!=="ru"?"En":"",[r.language]),[u,d]=(0,n.useState)(!1),h=(0,n.useCallback)(e=>()=>{d(e)},[]),p=(0,n.useCallback)(e=>()=>{a({style:e}),d(!1)},[a]),m=(0,n.useMemo)(()=>void 0!==t,[t]),v=(0,n.useMemo)(()=>m?l.find(e=>e.name===t)||null:s,[s,l,t,m]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{onClick:h(!0),className:g()(tP().styleItem,{[tP().withValue]:m}),style:{backgroundImage:"url(".concat(null==v?void 0:v.image,")")},children:(0,o.jsxs)("div",{className:tP().select,children:[(0,o.jsx)(tR,{className:tP().name,text:null==v?void 0:v["title".concat(c)]}),!m&&(0,o.jsx)(e2.Z,{name:"ic_24_arrow_small_down"})]})}),u&&!m&&(0,o.jsx)(tN.Z,{onClose:h(!1),removeHeader:!0,isOpen:u,buttons:[(0,o.jsx)(tL.Z,{children:i("close")},"close")],children:(0,o.jsx)("div",{className:tP().stylesList,onTouchMove:e=>{e.stopPropagation()},children:l.map(e=>(0,o.jsx)("div",{onClick:p(e.name),className:tP().styleItem,style:{backgroundImage:"url(".concat(null==e?void 0:e.image,")")},children:(0,o.jsx)(tR,{className:tP().name,text:e["title".concat(c)]})},e.name))})})]})},tT=e=>{let{value:t}=e,{t:a}=(0,e9.$)(),{addNotification:s}=(0,j.eY)({addNotification:tm.Mw}),l=(0,n.useCallback)(()=>{s({type:tr.Pu.INFO,message:a("tcs"),closable:!1}),navigator.clipboard.writeText(t)},[s,a,t]);return(0,o.jsxs)("div",{className:g()(to().textAreaWrap,to().textViewAreaWrap),children:[(0,o.jsx)("div",{className:to().infoIcon,onClick:l,children:(0,o.jsx)(e2.Z,{name:"ic_16_layers_copy"})}),(0,o.jsx)(tM.Z,{text:t,className:g()(to().textArea,to().textViewArea,"scrollbar-fb")})]})};var tz=a(27484),tY=a.n(tz);let tG=[{start:"2024.03.01 00:00:00",stop:"2024.03.31 23:59:59",icons:["\uD83C\uDF31","\uD83C\uDF3F","\uD83C\uDF33","\uD83C\uDF37","\uD83D\uDC90","\uD83D\uDD4A","☀️","⭐️"]},{start:"2024.04.01 00:00:00",stop:"2024.04.01 23:59:59",icons:["\uD83C\uDF89","\uD83E\uDD73","\uD83E\uDD21","\uD83C\uDFAA","\uD83D\uDE1D","\uD83E\uDD23","⭐️"]},{start:"2024.04.02 00:00:00",stop:"2024.04.10 23:59:59",icons:["\uD83C\uDF31","\uD83C\uDF3F","\uD83C\uDF33"," \uD83C\uDF37","\uD83D\uDC90","\uD83D\uDD4A","☀️","⭐️"]},{start:"2024.04.11 00:00:00",stop:"2024.04.12 23:59:59",icons:["\uD83E\uDDD1‍\uD83D\uDE80","‍\uD83D\uDE80","\uD83C\uDF0D","\uD83C\uDF0E","\uD83C\uDF0F"," \uD83D\uDE80","\uD83D\uDCAB","\uD83D\uDC7D","⭐️"]},{start:"2024.04.13 00:00:00",stop:"2024.05.31 23:59:59",icons:["\uD83C\uDF31","\uD83C\uDF3F","\uD83C\uDF33","\uD83C\uDF37","\uD83D\uDC90","\uD83D\uDD4A","☀️","⭐️"]},{start:"2024.06.01 00:00:00",stop:"2024.07.04 23:59:59",icons:["\uD83C\uDF3A","\uD83C\uDF38","\uD83C\uDF3C","\uD83C\uDF3B","\uD83C\uDF1E","\uD83C\uDF39","\uD83C\uDF33","☀️","\uD83C\uDF52","\uD83C\uDF53","\uD83C\uDF49","⭐️"]},{start:"2024.07.05 00:00:00",stop:"2024.07.06 23:59:59",icons:["\uD83D\uDE18","\uD83C\uDF39","\uD83D\uDC8B"]},{start:"2024.07.07 00:00:00",stop:"2024.08.31 23:59:59",icons:["\uD83C\uDF3A","\uD83C\uDF38","\uD83C\uDF3C","\uD83C\uDF3B","\uD83C\uDF1E","\uD83C\uDF39","\uD83C\uDF33","☀️","\uD83C\uDF52","\uD83C\uDF53","\uD83C\uDF49","⭐️"]},{start:"2024.09.01 00:00:00",stop:"2024.09.01 23:59:59",icons:["\uD83D\uDCDA","\uD83D\uDCD6","\uD83C\uDFEB","\uD83D\uDCDD","\uD83D\uDC69‍\uD83C\uDFEB","\uD83D\uDC68‍\uD83C\uDFEB","\uD83D\uDD8B️","⭐️"]},{start:"2024.09.02 00:00:00",stop:"2024.10.03 23:59:59",icons:["\uD83C\uDF42","\uD83C\uDF43","\uD83C\uDF41","\uD83C\uDF44","\uD83C\uDF3E","☀️","\uD83D\uDC9B","❤️","⭐️"]},{start:"2024.10.04 00:00:00",stop:"2024.10.05 23:59:59",icons:["\uD83D\uDCDA","\uD83D\uDCD6","\uD83C\uDFEB","\uD83D\uDCDD","\uD83D\uDC69‍\uD83C\uDFEB","\uD83D\uDC68‍\uD83C\uDFEB","\uD83D\uDD8B️","⭐️"]},{start:"2024.10.04 00:00:00",stop:"2024.10.29 23:59:59",icons:["\uD83C\uDF42","\uD83C\uDF43","\uD83C\uDF41","\uD83C\uDF44","\uD83C\uDF3E","☀️","\uD83D\uDC9B","❤️","⭐️"]},{start:"2024.10.30 00:00:00",stop:"2024.11.01 23:59:59",icons:["\uD83D\uDC7B","\uD83D\uDE31","\uD83C\uDF83","\uD83D\uDD6F","\uD83D\uDD2E","\uD83D\uDE08","\uD83D\uDC79","\uD83D\uDC80","\uD83E\uDDB4","\uD83C\uDF15","\uD83E\uDD87","\uD83C\uDF42","\uD83D\uDD78","\uD83D\uDD77","\uD83E\uDDDB‍","\uD83C\uDF6C","\uD83C\uDF6D","\uD83C\uDF6B","⭐️"]},{start:"2024.11.02 00:00:00",stop:"2024.11.30 23:59:59",icons:["\uD83C\uDF42","\uD83C\uDF43","\uD83C\uDF41","\uD83C\uDF44","\uD83C\uDF3E","☀️","\uD83D\uDC9B","❤️","⭐️"]},{start:"2024.12.01 00:00:00",stop:"2025.01.31 23:59:59",icons:["\uD83C\uDF84","❄️","⛄","\uD83C\uDF85","\uD83D\uDD14","⛸️","\uD83C\uDF89","\uD83C\uDF8A","\uD83C\uDF7E","\uD83E\uDD42","\uD83C\uDF81","⭐️"]},{start:"2025.02.01 00:00:00",stop:"2025.02.28 23:59:59",icons:["\uD83C\uDF84","❄️","⛄","\uD83C\uDF85","\uD83D\uDD14","⛸️","⭐️"]}],tB=()=>{var e,t;let a=tY()(),s=tG.filter(e=>tY()(a).isAfter(e.start)&&tY()(a).isBefore(e.stop));return null!==(t=null==s?void 0:null===(e=s[0])||void 0===e?void 0:e.icons)&&void 0!==t?t:["⭐"]},tO=e=>{var t,a,s,l,i,r,c,u,d,h;let{controlParams:p}=e,{textToImageModelParams:m,stylesList:v,startGeneration:y,addNotification:_,removeNotification:x,resetModelParams:f}=(0,j.eY)({textToImageModelParams:tc.R4,stylesList:tc.lO,startGeneration:eb.$A,addNotification:tm.Mw,removeNotification:tm.S6,resetModelParams:eY.V1}),{isPromptDisabled:b}=tv(),{isIos:w}=e4(),{t:D}=(0,e9.$)();(0,n.useEffect)(()=>{var e,t,a;(null==m?void 0:null===(e=m.negativePromptDecoder)||void 0===e?void 0:e.length)>1e3?_({id:"nPromptLenError",message:D("maxLen"),closable:!1,type:tr.Pu.ERROR,timeout:0}):x("nPromptLenError"),(null==m?void 0:null===(t=m.generateParams)||void 0===t?void 0:null===(a=t.query)||void 0===a?void 0:a.length)>1e3?_({id:"promptLenError",message:D("maxLen"),closable:!1,type:tr.Pu.ERROR,timeout:0}):x("promptLenError")},[_,x,D,null==m?void 0:null===(t=m.generateParams)||void 0===t?void 0:null===(a=t.query)||void 0===a?void 0:a.length,null==m?void 0:null===(s=m.negativePromptDecoder)||void 0===s?void 0:s.length]);let k=(0,n.useMemo)(()=>{var e,t,a,s,l;let o=null==m?void 0:null===(e=m.generateParams)||void 0===e?void 0:null===(t=e.query)||void 0===t?void 0:t.length,n=null==m?void 0:null===(a=m.negativePromptDecoder)||void 0===a?void 0:a.length;return[{id:1,label:D("prompt"),error:o>1e3?"".concat(o,"/1000"):null,showed:!p||(null==p?void 0:null===(s=p.prompt)||void 0===s?void 0:s.length)>0},{id:2,label:D("nPrompt"),error:n>1e3?"".concat(n,"/1000"):null,showed:!p||(null==p?void 0:null===(l=p.negativePrompt)||void 0===l?void 0:l.length)>0},{id:3,label:D("stylesT"),showed:!0}].filter(e=>e.showed)},[p,D,null==m?void 0:null===(l=m.generateParams)||void 0===l?void 0:null===(i=l.query)||void 0===i?void 0:i.length,null==m?void 0:null===(r=m.negativePromptDecoder)||void 0===r?void 0:r.length]),C=(0,n.useMemo)(()=>{var e,t,a;return"DEFAULT"!==m.style||(null==m?void 0:null===(e=m.generateParams)||void 0===e?void 0:null===(t=e.query)||void 0===t?void 0:t.length)>0||(null==m?void 0:null===(a=m.negativePromptDecoder)||void 0===a?void 0:a.length)>0},[null==m?void 0:null===(c=m.generateParams)||void 0===c?void 0:null===(u=c.query)||void 0===u?void 0:u.length,null==m?void 0:null===(d=m.negativePromptDecoder)||void 0===d?void 0:d.length,m.style]),[M,E]=(0,n.useState)(null===(h=k[0])||void 0===h?void 0:h.id),P=(0,n.useCallback)(e=>()=>{E(e)},[]);(0,n.useEffect)(()=>()=>{if(p){var e;E(null==k?void 0:null===(e=k[0])||void 0===e?void 0:e.id)}},[p,k]);let I=(0,n.useMemo)(()=>k.find(e=>e.id===M),[M,k]),F=(0,n.useCallback)(()=>{y(),(0,ep.F)("generatebyclick")},[y]),S=(0,n.useCallback)(()=>{f()},[f]),R=(0,n.useMemo)(()=>tB(),[]);return k.length<2?null:(0,o.jsxs)("div",{className:tk().root,onDoubleClick:e=>{e.stopPropagation()},children:[(0,o.jsxs)("ul",{className:tk().tabs,children:[k.map(e=>3===e.id&&0===v.length?null:(0,o.jsx)("li",{className:g()(tk().tab,{[tk().active]:e.id===I.id,[tk().error]:e.error}),onClick:P(e.id),children:(0,o.jsx)(t_.Z,{text:e.label})},e.id)),C&&!p&&(0,o.jsx)("li",{className:g()(tk().tab,tk().active,tk().reset),onClick:S,children:(0,o.jsx)(t_.Z,{text:D("reset")})})]}),(0,o.jsxs)("div",{className:g()(tk().content,{[tk().controlled]:p}),children:[1===I.id&&(p?(0,o.jsx)(tT,{value:null==p?void 0:p.prompt}):(0,o.jsx)(tD,{})),2===I.id&&(p?(0,o.jsx)(tT,{value:null==p?void 0:p.negativePrompt}):(0,o.jsx)(tw,{})),3===I.id&&(0,o.jsx)(tA,{value:null==p?void 0:p.style}),!p&&(0,o.jsx)(ty.C,{trigger:(0,o.jsx)(ta.H,{disabled:!1,emojiSet:R,amount:4,children:(0,o.jsx)("button",{disabled:b,type:"button",onClick:F,className:g()(tk().submit,{[tk().active]:!b}),children:(0,o.jsx)("div",{className:tk().submitContent,children:(0,o.jsx)(tC.Z,{active:!b})})})}),placement:"right-center",triggerOnHover:!0,children:(0,o.jsxs)(ty.Z,{children:[(0,o.jsx)(tM.Z,{text:D("create")}),(0,o.jsx)(t_.Z,{className:tk().keyCode,text:"".concat(w?"Cmd":"Ctrl"," + Enter")})]})})]}),I.error&&(0,o.jsx)(tM.Z,{className:tk().errorCount,text:I.error})]})};var tU=a(46134),t$=a.n(tU);let tV=[[1,1],[16,9],[9,16],[3,2],[2,3]],tW=()=>{let{setRatio:e,ratio:t}=(0,j.eY)({setRatio:K,ratio:S.lF}),a=(0,n.useCallback)((t,a)=>()=>{e([t,a])},[e]);return(0,o.jsx)("div",{className:t$().sizeList,children:tV.map(e=>(0,o.jsx)("div",{className:g()(t$().side,{[t$().active]:t[0]===e[0]&&t[1]===e[1]}),onClick:a(e[0],e[1]),children:(0,o.jsx)(t_.Z,{text:"".concat(e[0],":").concat(e[1])})},"".concat(e[0],":").concat(e[1])))})},tH=()=>{var e,t,a,s,l,i,r;let{eyeVirtualParams:c,scale:u,activeStateValue:{isImagePreviewActive:d,isEraserActive:h},selectControlsIsShown:p,updateEyeVirtualParams:m,preparingImg:v,imagePreview:y,position:x,acceptImagePreview:f,cancelImagePreview:b,selectedExist:w}=(0,j.eY)({eyeVirtualParams:S.pN,scale:_.$C,activeStateValue:ed.Mn,selectControlsIsShown:S.vd,updateEyeVirtualParams:ea,preparingImg:k.s2,imagePreview:W.IE,position:_.T9,acceptImagePreview:eb.$,cancelImagePreview:eb.pV,selectedExist:eM}),{t:D}=(0,e9.$)();(0,n.useEffect)(()=>{setTimeout(()=>{m()},100)},[m]);let C=(0,n.useMemo)(()=>!v,[v]);return!C||h||w?null:(0,o.jsxs)(o.Fragment,{children:[!d&&(0,o.jsxs)("div",{style:{transform:"translate(calc(".concat(c.x+c.width/2,"px - 50%), ").concat(c.y-34,"px)"),zIndex:10,pointerEvents:p?"auto":"none"},className:g()(t$().info,t$().selectItem,{[t$().eraserActive]:h}),children:[(0,o.jsx)(t_.Z,{className:t$().size,text:"".concat(Math.round(c.width/u.value),"x").concat(Math.round(c.height/u.value))}),(0,o.jsx)(tW,{})]}),d&&!y.isLoading&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{style:{transform:"translate(calc(".concat((null==y?void 0:null===(e=y.shapeProps)||void 0===e?void 0:e.x)*u.value+(null==y?void 0:null===(t=y.shapeProps)||void 0===t?void 0:t.width)*u.value/2+x.x,"px - 50%), ").concat((null==y?void 0:null===(a=y.shapeProps)||void 0===a?void 0:a.y)*u.value-34+x.y,"px)"),zIndex:10,position:"absolute"},className:g()(t$().info,t$().selectItem),children:(0,o.jsx)(t_.Z,{className:t$().size,text:"".concat(Math.round(null==y?void 0:y.shapeProps.width),"x").concat(Math.round(null==y?void 0:y.shapeProps.height))})}),(0,o.jsx)("div",{style:{transform:"translate(calc(".concat((null==y?void 0:null===(s=y.shapeProps)||void 0===s?void 0:s.x)*u.value+(null==y?void 0:null===(l=y.shapeProps)||void 0===l?void 0:l.width)*u.value/2+x.x,"px - 50%), ").concat((null==y?void 0:null===(i=y.shapeProps)||void 0===i?void 0:i.y)*u.value+(null==y?void 0:null===(r=y.shapeProps)||void 0===r?void 0:r.height)*u.value+8+x.y,"px)"),zIndex:10,pointerEvents:p?"auto":"none"},className:g()(t$().selectItem,{[t$().eraserActive]:h}),children:(0,o.jsxs)("div",{className:t$().buttons,children:[(0,o.jsxs)(tL.Z,{onClick:f,className:t$().acceptButton,children:[(0,o.jsx)(e2.Z,{name:"ic_16_ok"}),D("save")]}),(0,o.jsxs)(tL.Z,{buttonType:tL.L.CLEAR,onClick:b,className:t$().cancelButton,children:[(0,o.jsx)(e2.Z,{name:"ic_16_cross"}),D("cancel")]})]})})]}),!d&&(0,o.jsx)("div",{style:{transform:"translate(calc(".concat(c.x+c.width/2,"px - 50%), ").concat(c.y+c.height+8,"px)"),zIndex:10,pointerEvents:p?"auto":"none"},className:g()(t$().selectItem,{[t$().eraserActive]:h}),children:(0,o.jsx)(tO,{})})]})};var tq=a(5126),tX=a.n(tq);let tK=e=>{let{className:t,onChange:a,disabled:s,value:l,min:n=0,max:i=100}=e,r=e=>{let t=Math.max(1,parseInt(String(e.target.value),10));null==a||a(t)};return(0,o.jsx)("div",{className:g()(tX().root,t),children:(0,o.jsxs)("div",{className:tX().rangewrapper,children:[(0,o.jsx)("input",{className:g()(tX().customrange),type:"range",min:n,max:i,value:l,onChange:r,disabled:s}),(0,o.jsx)("div",{className:tX().sliderfill,style:{width:"calc(".concat(Math.max(5,(l-n)/(i-n)*100),"% + 10px)")}}),(0,o.jsx)("div",{className:tX().slidergray})]})})};var tJ=a(28531),tQ=a.n(tJ),t0=a(11610),t1=a(40078);let t3=e=>{let{x:t,y:a,width:s}=e;return{path:[t,a],width:s}},t2=(e,t)=>{let{x:a,y:s}=t;return{...e,path:[...e.path,a,s]}},t6=e=>{let[t,a,s,l,o,n,i]=e,r=s.reduce((e,t)=>{(0,ep.F)(i?"context_eraser":"global_eraser");let a=l.findOne("#image-object-eraser-".concat(t.id)),s=t.shape,r=null==a?void 0:a.toDataURL({x:s.x*o.value+n.x,y:s.y*o.value+n.y,width:s.width*o.value,height:s.height*o.value,pixelRatio:1/o.value,quality:1});if(r){let a=(0,t1.k)();return{...e,images:{...e.images,[a]:r},objects:{...e.objects,[t.id]:{...t,imageId:a}},groupIds:{...e.groupIds,[t.groupId]:!0}}}return e},{images:{},objects:{},groupIds:{}});return{eraserPath:null,images:{...t,...r.images},objects:{...a,...r.objects},groupIds:Object.keys(r.groupIds)}},t8=(0,x.yM)(),t5=(0,x.yM)(),t4=(0,x.yM)(),t7=(0,x.$e)(eH.U,_.$C,(e,t)=>e/t.value),t9=(0,x.yM)();(0,x.UP)({clock:t9,target:(0,z.h)({eraserPath:eH.w,images:W.lP,objects:W.hZ,groupIds:eb.Qj}),source:[W.lP,W.hZ,eK.bh,R.w5,_.$C,_.T9,eM],fn:t6}),(0,x.UP)({clock:t8,target:eH.w,fn:t3}),(0,x.UP)({clock:t5,target:eH.w,source:eH.w,fn:t2}),(0,x.UP)({clock:t4,target:eH.U}),(0,x.UP)({clock:[t9],target:(0,z.h)({previousFile:W.KR,previousId:W.YP}),fn:()=>({previousFile:null,previousId:null})});let ae=()=>{let{setEraserSize:e,eraserSize:t}=(0,j.eY)({setEraserSize:t4,eraserSize:eH.U}),{t:a}=(0,e9.$)(),s=(0,n.useCallback)(t=>{e(t)},[e]),l=(0,n.useCallback)(e=>{e.stopPropagation()},[]);return(0,o.jsx)(t0.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:tQ().root,onClick:l,children:(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:g()(tQ().row,tQ().container),children:[(0,o.jsx)(tM.Z,{className:tQ().name,text:a("radiusOfCurvature")}),(0,o.jsx)(ty.C,{placement:"right-start",trigger:(0,o.jsx)("div",{className:tQ().infoIcon,children:(0,o.jsx)(e2.Z,{name:"ic_16_info"})}),children:(0,o.jsxs)(ty.Z,{className:tQ().eraseHint,children:[(0,o.jsx)(t_.Z,{className:tQ().eraseHintText,html:"".concat(a("incBr")," <span>]</span>")}),(0,o.jsx)(t_.Z,{className:tQ().eraseHintText,html:"".concat(a("decBr")," <span>[</span>")})]})})]}),(0,o.jsx)("div",{className:g()(tQ().sliderWrap,tQ().eraserSliderWrap),children:(0,o.jsx)(tK,{value:t,min:2,max:10,onChange:s})})]})})};var at=a(88791),aa=a.n(at);let as=()=>{let{t:e}=(0,e9.$)(),{preparingImg:t,cancelGenerate:a}=(0,j.eY)({preparingImg:k.s2,cancelGenerate:eb.P});return t?(0,o.jsx)("div",{style:{zIndex:1e3},className:aa().root,children:(0,o.jsxs)("div",{className:aa().hint,children:[(0,o.jsx)("div",{className:aa().loadIcon,children:(0,o.jsx)(e2.Z,{name:"ic_16_ring_load"})}),(0,o.jsx)(tM.Z,{html:e("prepareImage")}),(0,o.jsxs)(tL.Z,{onClick:a,className:aa().cancel,buttonType:tL.L.CLEAR,children:[(0,o.jsx)(e2.Z,{name:"ic_16_cross"}),e("cancel")]})]})}):null};var al=a(33607),ao=a(65627),an=a(79914),ai=a.n(an);let ar=e=>{let{onClose:t}=e,{t:a}=(0,e9.$)(),{isIos:s}=e4(),l=(0,n.useMemo)(()=>[{key:"gi",elements:[(0,o.jsx)(al.Z,{className:ai().key,text:"G"},1)]},{key:"gtp",elements:[(0,o.jsx)(al.Z,{className:ai().key,text:"/"},1)]},{key:"er",elements:[(0,o.jsx)(al.Z,{className:ai().key,text:"E"},1)]},{key:"ins",elements:[(0,o.jsx)(al.Z,{className:ai().key,text:"I"},1)]},{key:"undo",elements:[(0,o.jsx)(al.Z,{className:ai().key,text:s?"Cmd":"Ctrl"},1),(0,o.jsx)(al.Z,{className:ai().key,text:"Z"},2)]},{key:"redo",elements:[(0,o.jsx)(al.Z,{className:ai().key,text:"Shift"},1),(0,o.jsx)(al.Z,{className:ai().key,text:s?"Cmd":"Ctrl"},2),(0,o.jsx)(al.Z,{className:ai().key,text:"Z"},3)]},{key:"sg",elements:[(0,o.jsx)(al.Z,{className:ai().key,text:s?"Cmd":"Ctrl"},1),(0,o.jsx)(al.Z,{className:ai().key,text:"Enter"},2)]},{key:"zi",elements:[(0,o.jsx)(al.Z,{className:ai().key,text:"+"},1)]},{key:"zo",elements:[(0,o.jsx)(al.Z,{className:ai().key,text:"-"},1)]},{key:"si",elements:[(0,o.jsx)(e2.Z,{name:"ic_36_mouse_left_btn"},1)]},{key:"nav",elements:[(0,o.jsx)(al.Z,{className:ai().key,text:"Space"},1),(0,o.jsx)(e2.Z,{name:"ic_36_mouse_left_btn"},2)]}],[s]);return(0,o.jsxs)(tN.Z,{onClose:t,contentClassName:ai().content,isOpen:!0,buttons:[(0,o.jsx)(tL.Z,{children:a("ok")},"close")],children:[(0,o.jsx)(ao.Z,{className:ai().header,text:a("controls.title")}),(0,o.jsx)("div",{id:"modal-window",className:ai().body,children:l.map(e=>(0,o.jsxs)("div",{className:ai().row,children:[(0,o.jsx)(tM.Z,{text:a("controls.".concat(e.key))}),(0,o.jsx)("div",{className:ai().keys,children:n.Children.toArray(e.elements)})]},e.key))})]})};var ac=a(51526);let au=()=>{let{t:e}=(0,e9.$)(),[t,a]=(0,n.useState)(!1),{isIos:s}=e4(),{showModal:i}=(0,h.dd)(),{historyLength:r,historyCurrentIndex:c,activeStateValue:u,toggleLayerOpened:d,isLayerOpen:p,historyUndo:m,historyRedo:v,selectedExist:g,objectsCount:y,preparingImg:_,imagePreview:x}=(0,j.eY)({activeStateValue:ed.Mn,toggleLayerOpened:k.nu,isLayerOpen:ed.g9,historyLength:tp.$length,historyCurrentIndex:tp.$curIndex,historyUndo:td,historyRedo:th,selectedExist:eM,objectsCount:eK.RH,preparingImg:k.s2,imagePreview:W.IE}),f=(0,n.useCallback)(()=>{a(!t)},[t]),{toggleDownloadState:b,handleStateChange:w,handleFileChange:D,isInterfaceDisabled:C,isGenerateActive:M,isEraseActiveState:E,handleInsertClick:P,moveSelectedToCenter:I,deleteSelected:F,duplicateSelected:S}=tv(),R=(0,n.useCallback)(()=>{i("PROMPT_INFO_MODAL")},[i]),N=(0,n.useMemo)(()=>(0,o.jsxs)(o.Fragment,{children:[t&&(0,o.jsx)(ar,{onClose:f}),(0,o.jsxs)("div",{className:e3().panel,onDoubleClick:e=>{e.stopPropagation()},children:[!C&&(0,o.jsx)(ac.M,{children:E&&(0,o.jsx)(ae,{})}),!C&&!x&&(0,o.jsxs)(o.Fragment,{children:[!g&&(0,o.jsx)(e7,{active:M,tooltip:M?null:e("tip.generate"),tip:M?null:"G",onClick:w(l.generate),children:(0,o.jsx)(e2.Z,{name:"ic_16_sparks_stars"})}),(0,o.jsx)(e7,{onClick:w(l.erase),active:E,tooltip:E?null:e("tip.erase"),tip:E?null:"E",children:(0,o.jsx)(e2.Z,{name:"ic_16_eraser"})}),!g&&(0,o.jsxs)(e7,{active:u.isImagePreviewActive,tooltip:e("tip.insert"),tip:"I",children:[(0,o.jsx)("div",{className:e3().uploadButton,onClick:P,children:(0,o.jsx)("input",{accept:"image/jpeg, image/png",type:"file",onChange:D,id:"insert-preview-image-input"})}),(0,o.jsx)(e2.Z,{name:"ic_16_picture_plus"})]}),(0,o.jsx)("div",{className:e3().separate}),!g&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e7,{disabled:r<=1||c<=1,tooltip:e("tip.undo"),tip:"".concat(s?"Cmd":"Ctrl"," + Z"),onClick:m,children:(0,o.jsx)(e2.Z,{name:"ic_16_arrow_reverse"})}),(0,o.jsx)(e7,{disabled:r<=1||c>=r-1,tooltip:e("tip.redo"),tip:"Shift + ".concat(s?"Cmd":"Ctrl"," + Z"),onClick:v,children:(0,o.jsx)(e2.Z,{name:"ic_16_arrow_forward"})}),(0,o.jsx)("div",{className:e3().separate})]}),!g&&(0,o.jsx)(e7,{onClick:f,children:(0,o.jsx)(e2.Z,{name:"ic_16_keyboard"})}),!g&&(0,o.jsx)(e7,{onClick:R,children:(0,o.jsx)(e2.Z,{name:"ic_16_question_outline"})}),g&&(0,o.jsx)(e7,{onClick:I,tooltip:e("tip.move"),children:(0,o.jsx)(e2.Z,{name:"ic_16_locate"})}),g&&(0,o.jsx)(e7,{onClick:S,tooltip:e("tip.duplicate"),children:(0,o.jsx)(e2.Z,{name:"ic_16_layers_copy"})}),!g&&!x&&(0,o.jsx)("div",{className:e3().separate})]}),(!_||y>0)&&!x&&(0,o.jsxs)(e7,{tooltip:e("tip.download"),onClick:b,disabled:!y,children:[(0,o.jsx)("div",{className:e3().downloadIcon,children:(0,o.jsx)(e2.Z,{name:"ic_16_arrow_download"})}),!g&&(0,o.jsx)("div",{children:e("downloadAll")})]}),g&&!_&&(0,o.jsx)(e7,{tooltip:e("tip.delete"),onClick:F,children:(0,o.jsx)(e2.Z,{name:"ic_16_trash_delete"})}),(!_||y>0)&&!x&&(0,o.jsx)("div",{className:e3().separate}),(0,o.jsx)(tt,{})]}),!_&&!x&&(0,o.jsx)("div",{className:e3().rightPanel,children:(0,o.jsx)(e7,{active:p&&y>0,onClick:d,disabled:y<=0,children:(0,o.jsx)(e2.Z,{name:"ic_16_layers"})})}),(0,o.jsx)(tH,{}),(0,o.jsx)(as,{})]}),[u.isImagePreviewActive,F,S,D,R,P,w,c,r,v,m,x,E,M,C,s,t,p,I,y,_,g,e,b,f,d]);return N};var ad=a(59251);let ah=()=>{let e=window.location.hostname.match(/[-\w]+\.(?:[-\w]+\.xn--[-\w]+|[-\w]{3,}|[-\w]+\.[-\w]{2})$/i);return e?e[0]:window.location.hostname};var ap=a(39153),am=a(12593),av=a.n(am);let ag=()=>{try{return eT.Z.get("fb-cookies-accept")}catch(e){return!1}},ay=e=>{let{style:t,classNames:a}=e,{t:s}=(0,e9.$)(),{pathname:l}=(0,ez.useRouter)(),[i,r]=(0,n.useState)(),{checkQueryToGenerate:c}=eG(),u=(0,ap.b)(),d=ag(),h=(0,n.useCallback)(e=>{e.stopPropagation(),e.preventDefault();try{eT.Z.set("fb-cookies-accept","1",{domain:".".concat(ah())})}catch(e){r(!1)}r(!1),c()},[c]);return(void 0===i?!d:i)?(0,o.jsxs)("div",{className:g()(av().wrap,a,{[av().visible]:"/"!==l}),style:t,children:[(0,o.jsx)("p",{className:av().text,children:(0,o.jsxs)(ad.c,{t:s,i18nKey:"cookie",children:["text",(0,o.jsx)("a",{target:"_blank",rel:"noreferrer noopener nofollow",href:"https://fusionbrain.ai/static/fusion/".concat(u,"/docs/personal.pdf"),children:"text"}),(0,o.jsx)("a",{target:"_blank",rel:"noreferrer noopener nofollow",href:"https://fusionbrain.ai/static/fusion/".concat(u,"/docs/agreement.pdf"),children:"text"})]})}),(0,o.jsx)("button",{type:"button",className:av().button,onClick:h,children:s("agree")})]}):null},a_=()=>{let[e,t]=(0,n.useState)(!1),{onSelectMoveStop:a,onSelectMove:s}=eA(),l=(0,n.useRef)({x:0,y:0}),{scale:o,setPosition:i,setScale:r,preparingImg:c,isMove:u,setIsMove:d,activeStateValue:h,createEraserPath:p,drawEraserPath:m,eraserSize:v,erasePath:g,submitErasePath:y,imagePreview:x,stageNodeRef:f,eraserNodeRef:b}=(0,j.eY)({scale:_.$C,setPosition:L,setScale:A,preparingImg:k.s2,isMove:ed.uS,setIsMove:k.r3,activeStateValue:ed.Mn,drawEraserPath:t5,createEraserPath:t8,eraserSize:t7,erasePath:eH.w,submitErasePath:t9,imagePreview:W.IE,stageNodeRef:R.xD,eraserNodeRef:R.FR}),{isEraserActive:w}=h,D=(0,n.useRef)(null),C=(0,n.useRef)(0),M=(0,n.useRef)({x:0,y:0}),E=(0,n.useRef)(null),[P,I]=(0,n.useState)(!1),F=(0,n.useCallback)((e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),[]),S=(0,n.useCallback)((e,t)=>({x:(e.x+t.x)/2,y:(e.y+t.y)/2}),[]),N=(0,n.useCallback)(()=>{if(w&&f){let e=f.getRelativePointerPosition();p({x:e.x,y:e.y,width:v}),m({x:e.x,y:e.y}),E.current=setTimeout(()=>{m({x:e.x,y:e.y})},100)}},[p,m,v,w,f]),Z=(0,n.useCallback)(()=>{I(!0),c||N()},[c,N]),T=(0,n.useCallback)(()=>{var e;I(!1),a(),l.current={x:0,y:0},(null==g?void 0:g.path)&&(null==g?void 0:null===(e=g.path)||void 0===e?void 0:e.length)!==0&&setTimeout(()=>{y()},101)},[null==g?void 0:g.path,a,y]),z=(0,n.useCallback)(()=>{if(f){let e=f.getPointerPosition();e&&b&&b.position({x:e.x/o.value,y:e.y/o.value})}},[b,o.value,f]),Y=(0,n.useCallback)(e=>{if(f){var t;let a=f.getRelativePointerPosition();z(),E.current&&clearTimeout(E.current),w&&(P||(null===(t=e.evt)||void 0===t?void 0:t.touches))&&m({x:a.x,y:a.y})}},[m,w,P,z,f]),G=(0,n.useCallback)(e=>{let a=e.evt,s=a.touches;if(I(!0),a.touches.length>1&&(d(!0),t(!0)),s){let e=null==s?void 0:s[0];M.current={x:e.clientX,y:e.clientY}}s&&w&&f&&(z(),N())},[w,z,d,f,N]),B=(0,n.useCallback)(()=>{var e;I(!1),a(),(null==g?void 0:g.path)&&(null==g?void 0:null===(e=g.path)||void 0===e?void 0:e.length)!==0&&setTimeout(()=>{y()},101),C.current=0,D.current=null,d(!1),setTimeout(()=>{t(!1)},500)},[null==g?void 0:g.path,a,d,y]),O=(0,n.useCallback)(e=>{i(e)},[i]),U=(0,n.useCallback)(e=>{let t=e.evt;if(t||(t=window.event),w&&z(),f){let e;t.wheelDeltaX||t.wheelDeltaY?(e={x:f.x()+t.wheelDeltaX/5,y:f.y()+t.wheelDeltaY/5},l.current={x:l.current.x+t.wheelDeltaX/5,y:l.current.y+t.wheelDeltaY/5}):(e={x:f.x()+t.movementX,y:f.y()+t.movementY},l.current={x:l.current.x+t.movementX,y:l.current.y+t.movementY}),O(e)}},[w,z,f,O]),$=(0,n.useCallback)(e=>{b&&b.opacity(1),P&&(0!==l.current.x||0!==l.current.y)&&s(),u&&P?U(e):!u&&b&&!c&&w&&Y(e)},[u,w,Y,b,P,c,U,s]),V=(0,n.useCallback)(e=>{if(f){let t=f.scaleX(),{x:a,y:s}=f.getPointerPosition(),l={x:(a-f.x())/t,y:(s-f.y())/t},o=Math.max(.1,Math.min(e.deltaY<0?1.0504*t:t/1.0504,1.5));f.scale({x:o,y:o});let n={x:a-l.x*o,y:s-l.y*o};f.position(n),i(n),z(),r(o),b&&b.opacity(0)}},[b,z,i,r,f]),H=(0,n.useCallback)(t=>{let a=t.evt;b&&b.opacity(1),P&&s(),a||(a=window.event);let l=null==a?void 0:a.touches,n=l[0];if(w)Y(t);else if(f){if(l.length>1){let e=a.touches[0],t=a.touches[1];if(e&&t){var c,d;a.preventDefault(),a.stopPropagation(),f.isDragging()&&f.stopDrag();let s={x:e.clientX,y:e.clientY},l={x:t.clientX,y:t.clientY};if(!D.current){D.current=S(s,l);return}let n=S(s,l),u=F(s,l);C.current||(C.current=u);let h={x:(n.x-f.x())/f.scaleX(),y:(n.y-f.y())/f.scaleX()},p=Math.max(.1,Math.min(f.scaleX()*(u/C.current),1.5)),m=n.x-(null==D?void 0:null===(c=D.current)||void 0===c?void 0:c.x),v=n.y-(null==D?void 0:null===(d=D.current)||void 0===d?void 0:d.y),g={x:n.x-h.x*p+m,y:n.y-h.y*p+v};i(g),o.value=p,r(p),C.current=u,D.current=n}}else if(!e&&!x&&!u){let e={x:f.getPosition().x+(n.pageX-M.current.x),y:f.getPosition().y+(n.pageY-M.current.y)};M.current={x:n.pageX,y:n.pageY},O(e)}}},[Y,b,S,F,x,w,e,P,u,s,o,i,r,f,O]),q=(0,n.useCallback)(e=>{let t=e.evt;t||(t=window.event),t.preventDefault(),t.stopPropagation(),t.ctrlKey?V(t):U(e)},[U,V]),X=(0,n.useCallback)(()=>{w&&b&&(null==b||b.opacity(1),z())},[w,b,z]),K=(0,n.useCallback)(()=>{var e;(null==g?void 0:g.path)&&(null==g?void 0:null===(e=g.path)||void 0===e?void 0:e.length)!==0&&(y(),I(!1)),b&&b.opacity(0)},[null==g?void 0:g.path,b,y]);return{onWheel:q,onTouchMove:H,onTouchEnd:B,onTouchStart:G,onMouseDown:Z,onMouseMove:$,onMouseUp:T,isMouseDown:P,onMouseEnter:X,onMouseLeave:K}};function ax(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".object",{stageNodeRef:t,mainLayerNodeRef:a}=(0,j.eY)({stageNodeRef:R.xD,mainLayerNodeRef:R.V6}),s=(0,n.useCallback)(s=>{if(!t||!a)return{};{let l=[0,t.width()/2,t.width()],o=[0,t.height()/2,t.height()];return a.find(e).forEach(e=>{if(e===s)return;let t=e.getClientRect();l.push([t.x,t.x+t.width,t.x+t.width/2]),o.push([t.y,t.y+t.height,t.y+t.height/2])}),{vertical:l.flat(),horizontal:o.flat()}}},[a,e,t]),l=(0,n.useCallback)(e=>{let t=e.getClientRect(),a=e.absolutePosition();return{vertical:[{guide:Math.round(t.x),offset:Math.round(a.x-t.x),snap:"start"},{guide:Math.round(t.x+t.width/2),offset:Math.round(a.x-t.x-t.width/2),snap:"center"},{guide:Math.round(t.x+t.width),offset:Math.round(a.x-t.x-t.width),snap:"end"}],horizontal:[{guide:Math.round(t.y),offset:Math.round(a.y-t.y),snap:"start"},{guide:Math.round(t.y+t.height/2),offset:Math.round(a.y-t.y-t.height/2),snap:"center"},{guide:Math.round(t.y+t.height),offset:Math.round(a.y-t.y-t.height),snap:"end"}]}},[]),o=(0,n.useCallback)((e,t)=>{let a=[],s=[];e.vertical.forEach(e=>{t.vertical.forEach(t=>{let s=Math.abs(e-t.guide);s<4&&a.push({lineGuide:e,diff:s,snap:t.snap,offset:t.offset})})}),e.horizontal.forEach(e=>{t.horizontal.forEach(t=>{let a=Math.abs(e-t.guide);a<4&&s.push({lineGuide:e,diff:a,snap:t.snap,offset:t.offset})})});let l=[],o=a.sort((e,t)=>e.diff-t.diff)[0],n=s.sort((e,t)=>e.diff-t.diff)[0];return o&&l.push({lineGuide:o.lineGuide,offset:o.offset,orientation:"V",snap:o.snap}),n&&l.push({lineGuide:n.lineGuide,offset:n.offset,orientation:"H",snap:n.snap}),l},[]),i=(0,n.useCallback)(e=>{let t=s(e.target),a=l(e.target),n=o(t,a);if(0!==n.length){let t=e.target.absolutePosition();n.forEach(a=>{switch(a.snap){case"start":switch(a.orientation){case"V":t.x=a.lineGuide+a.offset-1;break;case"H":t.y=a.lineGuide+a.offset}break;case"center":switch(a.orientation){case"V":t.x=a.lineGuide+a.offset;break;case"H":t.y=a.lineGuide+a.offset}break;case"end":switch(a.orientation){case"V":t.x=a.lineGuide+a.offset+1;break;case"H":t.y=a.lineGuide+a.offset}}e.target.absolutePosition(t)})}},[o,s,l]);return{handleDrag:i}}let af=(0,x.yM)();(0,x.UP)({clock:af,target:(0,z.h)({stageNodeRef:R.xD,selectTransformRef:R.Lr,selectRectRef:R.iL,mainLayerNodeRef:R.V6,secondLayerNode:R.dB,fixedLayerNodeRef:R.aD,eraserNodeRef:R.FR,tempEraseRef:R.nJ,imageRectRef:R.f9,eraserObjectsRef:R.w5,eraserCircleRef:R.py}),fn:e=>{let{refKey:t,refValue:a}=e;return{[t]:a}}});let ab=e=>{let{isShowed:t}=e,{eyePosition:a,eyeSize:s,scale:{value:l},setEyePosition:i,setEyeSize:r,toggleSelectHoveredState:c,eyeRatio:u,updateEyeParams:d,preparingImg:h,activeStateValue:{isImagePreviewActive:p,isEraserActive:v},updateIntersect:g,eyeMovingStart:y,isMove:x,setRef:f,selectRectRef:b,selectTransformRef:w}=(0,j.eY)({eyePosition:S.YG,eyeSize:S.RR,eyeRatio:S.lF,scale:_.$C,setEyePosition:q,setEyeSize:X,toggleSelectHoveredState:k.Gc,updateEyeParams:et,eyeMovingStart:en,preparingImg:k.s2,activeStateValue:ed.Mn,updateIntersect:eb.bz,isMove:ed.uS,setRef:af,selectRectRef:R.iL,selectTransformRef:R.Lr}),{height:D,width:C}=s,{x:M,y:E}=a,{isMobile:P,isTablet:I}=e4(),{handleDrag:F}=ax(".stickyObject");(0,n.useEffect)(()=>{w&&b&&w.nodes([b])},[b,w]);let N=(0,n.useCallback)(()=>{if(b){let e=b.scaleX(),t=b.scaleY();b.scaleX(1),b.scaleY(1),i({x:b.x(),y:b.y()}),r({width:Math.max(5,b.width()*e),height:Math.max(b.height()*t)})}},[b,i,r]),L=(0,n.useCallback)(()=>{g()},[g]),Z=(0,n.useCallback)(()=>{g()},[g]),A=(0,n.useCallback)(()=>{c(!0)},[c]),T=(0,n.useCallback)(()=>{c(!1)},[c]),z=(0,n.useCallback)(e=>{d({x:e.target.x(),y:e.target.y()})},[d]),G=(0,n.useCallback)((e,t)=>{let a=Y(128,128,u[0],u[1]),s=Y(1024,1024,u[0],u[1]);return t.width<=128*l||t.height<=128*l?{...e,height:a.height*l,width:a.width*l}:t.height>=1024*l||t.width>=1024*l?{...e,width:s.width*l,height:s.height*l}:t},[l,u]),B=(0,n.useCallback)(e=>{f({refKey:"selectTransformRef",refValue:e})},[f]),O=(0,n.useCallback)(e=>{f({refKey:"selectRectRef",refValue:e})},[f]),U=(0,n.useCallback)(e=>{F(e),N()},[F,N]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(m.UL,{x:M,y:E,width:C,height:D,draggable:!0,ref:O,onMouseEnter:A,onMouseLeave:T,onDragMove:U,onDragEnd:L,onTransform:N,onTransformEnd:Z,onTouchEnd:z,onTouchStart:y,listening:t,perfectDrawEnabled:!1,shadowEnabled:!1}),(0,o.jsx)(m.$T,{draggable:!1,keepRatio:!0,rotateEnabled:!1,anchorFill:"#000",borderStroke:"#A8CE73",borderStrokeWidth:1,anchorStroke:"#A8CE73",anchorCornerRadius:30,enabledAnchors:P||I||x||v||h||p?[]:["top-left","top-right","bottom-left","bottom-right"],ref:B,boundBoxFunc:G,opacity:t?1:0,listening:t,perfectDrawEnabled:!1,shadowEnabled:!1})]})},aw=e=>{let{width:t=1024,height:a=1024,y:s=0,x:l=0}=e,i=(0,n.useRef)(null),{scale:{value:r}}=(0,j.eY)({scale:_.$C}),c=(0,n.useCallback)(()=>{if(i.current){let e=[],s=0,l=500*r,o=i.current,n=()=>{s<1&&(s+=.01,o&&o.opacity(Math.min(1,s)));for(let s=0;s<e.length;s++){let l=e[s];l.op>1?l.factor=-1:l.op<=0&&(l.factor=1,l.position({x:Math.round(Math.random()*t),y:Math.round(Math.random()*a)})),l.op=Math.max(0,l.op+l.increment*l.factor),l.opacity(l.op)}requestAnimationFrame(n)};window.requestAnimationFrame(n),(()=>{o.find("Star").forEach(e=>e.destroy());for(let s=0;s<l;s++){let s=Math.random(),l=new(eO()).Star({x:Math.round(Math.random()*t),y:Math.round(Math.random()*a),opacity:s,numPoints:4,innerRadius:1+2*Math.random(),outerRadius:1+4*Math.random(),fill:"rgba(255,255,255, 1)",transformsEnabled:"position",perfectDrawEnabled:!1,shadowEnabled:!1});l.op=s,l.length=1+Math.random(),l.factor=.5,l.increment=.08*Math.random(),e.push(l),o&&o.add(l)}})()}},[a,r,t]);return(0,n.useEffect)(()=>{c()},[c]),(0,o.jsx)(m.ZA,{opacity:0,ref:i,listening:!1,width:t||0,height:a||0,x:l||0,y:s||0,children:(0,o.jsx)(m.UL,{strokeWidth:1,stroke:"rgba(168, 206, 115, 1)",opacity:.7,fill:"#090909",x:0,y:0,height:a||0,width:t||0,shadowColor:"rgba(0, 0, 0, 1)"})})},aD=e=>{let{previewImage:{shapeProps:t,imageId:a,isLoading:s,id:l,imageUrl:i}}=e,r=n.useRef(null),{updateImagePreviewParams:c,setImageFileFn:u,files:d,imageRectRef:h,setRef:p}=(0,j.eY)({updateImagePreviewParams:eb.QZ,setImageFileFn:eb.T2,files:W.lP,imageRectRef:R.f9,setRef:af}),v=(0,n.useMemo)(()=>d[a],[d,a]),g=(0,n.useCallback)(e=>{u({id:l,file:e})},[l,u]),{isLoading:y,image:_}=eW(i,v,g);(0,n.useEffect)(()=>{h&&!y&&_&&r.current.nodes([h])},[_,y,h]);let x=(0,n.useCallback)(e=>{c({shapeProps:{...t,x:e.target.x(),y:e.target.y()}})},[t,c]),f=(0,n.useCallback)(()=>{if(h){let e=h.scaleX(),t=h.scaleY();h.scaleX(1),h.scaleY(1),c({shapeProps:{x:h.x(),y:h.y(),width:Math.max(5,h.width()*e),height:Math.max(h.height()*t)}})}},[h,c]),b=(0,n.useCallback)(e=>{p({refKey:"imageRectRef",refValue:e})},[p]);return(0,o.jsxs)(o.Fragment,{children:[_&&!y&&(0,o.jsx)(m.Ee,{...t,draggable:!0,ref:b,image:_,onDragMove:x,onTransform:f,perfectDrawEnabled:!1,shadowEnabled:!1,transformsEnabled:"all"}),(0,o.jsx)(m.$T,{keepRatio:!0,rotateEnabled:!1,borderStroke:"#A8CE73",enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],anchorFill:"#A8CE73",anchorStroke:"#A8CE73",anchorCornerRadius:30,borderDash:[10,10],ref:r,boundBoxFunc:(e,t)=>t.width<5||t.height<5?e:t}),(s||y)&&(0,o.jsx)(aw,{...t})]})};var aj=()=>{let{isImagePreviewActive:e,acceptImagePreview:t,isSelectedExist:a,startGeneration:s,setInputIsInFocus:l,cancelImagePreview:o,clearSelected:i,setScale:r,isInputIsInFocus:c,scale:{value:u},setIsMove:d,toggleEraser:h,activeStateValue:{isGenerateActive:p,isEraserActive:m},setEraserSize:v,eraserSizeValue:g,historyUndo:y,historyRedo:x,historyLength:f,historyCurrentIndex:b,setActiveState:w,stageNodeRef:D,eraserNodeRef:C,preparingImg:M,cancelGenerate:E}=(0,j.eY)({isImagePreviewActive:W.IE,acceptImagePreview:eb.$,isSelectedExist:eM,startGeneration:eb.$A,setInputIsInFocus:k.VI,cancelImagePreview:eb.pV,clearSelected:eC,setScale:A,scale:_.$C,isInputIsInFocus:ed.ql,setIsMove:k.r3,toggleEraser:k.fp,activeStateValue:ed.Mn,setEraserSize:t4,eraserSizeValue:eH.U,historyUndo:td,historyRedo:th,historyLength:tp.$length,historyCurrentIndex:tp.$curIndex,setActiveState:k.k$,stageNodeRef:R.xD,eraserNodeRef:R.FR,preparingImg:k.s2,cancelGenerate:eb.P}),{handleStateChange:P,isInterfaceDisabled:I,isPromptDisabled:F}=tv(),S=(0,n.useCallback)(n=>{var _,j;if(!document.getElementById("modal-window")){if("Escape"===n.key&&(m?w("generate"):e?o():a?i():M&&E()),"Enter"===n.key&&!M&&(e&&t(),(n.metaKey||n.ctrlKey)&&"Enter"===n.key&&!F&&p&&!a&&(n.preventDefault(),s(),l(!1),(0,ep.F)("generatebyhotkey"))),"-"!==n.key||c||r(Math.max(u-.1,.1)),"/"!==n.key&&191!==n.keyCode||c||M||(n.stopPropagation(),n.preventDefault(),null===(_=document.getElementById("textAreaAutoFocus"))||void 0===_||_.focus()),"="!==n.key&&"+"!==n.key||c||r(Math.min(u+.1,1.5)),"Space"!==n.code||c||d(!0),!c&&!e&&!M){if(m&&(("["===n.key||"х"===n.key.toLowerCase())&&v(Math.max(2,g-1)),("]"===n.key||"ъ"===n.key.toLowerCase())&&v(Math.min(10,g+1))),"e"===n.key.toLowerCase()||"у"===n.key.toLowerCase()){h(),(0,ep.F)("erasebyhotkey"),C&&C.opacity(1);let e=null==D?void 0:D.getPointerPosition();e&&C&&C.position({x:e.x/u,y:e.y/u})}"g"!==n.key.toLowerCase()&&"п"!==n.key.toLowerCase()||a||P("generate")()}c||a||e||M||(("i"===n.key.toLowerCase()||"ш"===n.key.toLowerCase())&&(null===(j=document.getElementById("insert-preview-image-input"))||void 0===j||j.click(),(0,ep.F)("insertimagebyhotkey")),!I&&(n.metaKey||n.ctrlKey)&&!n.shiftKey&&("z"===n.key.toLowerCase()||"я"===n.key.toLowerCase())&&!c&&f>1&&b>1&&(n.preventDefault(),y(),(0,ep.F)("backbyhotkey")),!I&&(n.metaKey||n.ctrlKey)&&n.shiftKey&&("z"===n.key.toLowerCase()||"я"===n.key.toLowerCase())&&!c&&f>=1&&b<f-1&&(n.preventDefault(),x(),(0,ep.F)("forwardbyhotkey")))}},[t,E,o,i,C,g,P,b,f,x,y,m,p,e,c,I,F,a,M,u,w,v,l,d,r,D,s,h]),N=(0,n.useCallback)(()=>{d(!1)},[d]),L=(0,n.useCallback)(e=>{1!==e.scale&&e.preventDefault()},[]);(0,n.useEffect)(()=>(window.addEventListener("keydown",S),window.addEventListener("keyup",N),document.addEventListener("touchmove",L,{passive:!1}),()=>{document.removeEventListener("touchmove",L),window.removeEventListener("keyup",N),window.removeEventListener("keydown",S)}),[L,S,N])},ak=a(86078),aC=a(10630),aM=a.n(aC);let aE=()=>{let{preparingImg:e,selected:t,selectedGroups:a,selectedShape:s,scale:{value:l},objects:i,position:r,mainLayerNodeRef:c,stageNodeRef:u}=(0,j.eY)({preparingImg:k.s2,selected:eh.J1,selectedGroups:eh.d1,selectedShape:eh.Dx,scale:_.$C,objects:W.hZ,position:_.T9,stageNodeRef:R.xD,mainLayerNodeRef:R.V6}),d=(0,n.useMemo)(()=>{var n,r,c,u;if(1!==t.length&&1!==a.length||!s||e)return null;let d=i[t[0]];return(0,o.jsxs)(o.Fragment,{children:[t.length+a.length<=1&&(0,o.jsx)("div",{style:{left:s.x+s.width/2,top:s.y-34,zIndex:10,position:"absolute"},className:g()(aM().info,aM().selectItem),children:(0,o.jsx)(t_.Z,{className:aM().size,text:"".concat(Math.round(s.width/l),"x").concat(Math.round(s.height/l))})}),1===t.length&&0===a.length&&(null==d?void 0:d.generateParams)&&(0,o.jsx)("div",{style:{left:s.x+s.width/2,top:s.y+s.height+12,zIndex:10,position:"absolute"},className:aM().metaView,children:(0,o.jsx)(tO,{controlParams:{style:null==d?void 0:d.generateParams.style,prompt:(null==d?void 0:null===(n=d.generateParams)||void 0===n?void 0:null===(r=n.generateParams)||void 0===r?void 0:r.query)||(null==d?void 0:null===(c=d.generateParams)||void 0===c?void 0:null===(u=c.inPaintingParams)||void 0===u?void 0:u.query),negativePrompt:null==d?void 0:d.generateParams.negativePromptDecoder}})})]})},[i,e,l,t,a.length,s]),h=(0,n.useMemo)(()=>e?[...a,...t].map(e=>{let t=c.findOne("#".concat(e)),a=t?t.getClientRect({relativeTo:u}):null;if(!a)return null;let s={width:a.width*l,height:a.height*l,x:a.x*l+r.x,y:a.y*l+r.y};return(0,o.jsxs)(n.Fragment,{children:[(0,o.jsx)("div",{style:{left:s.x+s.width/2,top:s.y-34,zIndex:11,position:"absolute"},className:g()(aM().info,aM().selectItem),children:(0,o.jsx)(t_.Z,{className:aM().size,text:"".concat(Math.round(s.width/l),"x").concat(Math.round(s.height/l))})}),(0,o.jsx)("div",{style:{left:s.x,top:s.y,zIndex:10,position:"absolute",width:s.width,height:s.height},className:aM().groupShapeBorder})]},e)}):null,[c,r.x,r.y,e,l,t,a,u]);return(0,o.jsxs)(o.Fragment,{children:[d,h]})};var aP=a(68901),aI=a(69769),aF=a.n(aI);let aS=()=>{let{t:e}=(0,e9.$)(),{handleFileChange:t}=tv(),{addNotification:a,clearSelection:s,preparingImg:l}=(0,j.eY)({addNotification:tm.Mw,clearSelection:eC,preparingImg:k.s2}),i=(0,n.useRef)(null),r=(0,n.useCallback)(e=>{l||(s(),t({value:"",target:{files:e,blur:()=>void 0}}))},[s,t,l]),c=(0,n.useCallback)(()=>{a({message:e("errors.fileFormat"),type:tr.Pu.ERROR,closable:!1})},[a,e]),{getRootProps:u,getInputProps:d,rootRef:h}=(0,aP.uI)({onDropAccepted:r,onDropRejected:c,accept:{"image/png":[".png"],"image/jpeg":[".jpg",".jpeg"]},multiple:!1});return(0,n.useEffect)(()=>{let e=e=>{switch(e.preventDefault(),e.type){case"dragenter":i.current=e.target,h.current.classList.add(aF().dropzoneActive);break;case"dragleave":(e.target===i.current||e.target===document)&&h.current.classList.remove(aF().dropzoneActive);break;case"dragend":case"drop":h.current.classList.remove(aF().dropzoneActive)}};return document.body.addEventListener("dragenter",e,!0),document.body.addEventListener("dragleave",e,!0),document.body.addEventListener("dragend",e,!0),document.body.addEventListener("drop",e,!0),()=>{document.body.removeEventListener("dragenter",e,!0),document.body.removeEventListener("dragleave",e,!0),document.body.removeEventListener("dragend",e,!0),document.body.removeEventListener("drop",e,!0)}},[h]),(0,o.jsxs)("div",{id:"dropzone",...u({className:g()(aF().dropzone,{[aF().preparingImg]:l})}),children:[(0,o.jsx)("input",{...d()}),(0,o.jsx)(tr.ZT,{size:32,text:e(l?"dragFileDuringGenerate":"dragFile")})]})},aR=()=>{let{selected:e,selectedGroups:t,objects:a,scale:{value:s},updateObjectsByObjectsArray:l,updateGroupPreview:i,activeStateValue:{isEraserActive:r}}=(0,j.eY)({selected:eh.J1,selectedGroups:eh.d1,objects:W.hZ,scale:_.$C,updateObjectsByObjectsArray:eb.X9,updateGroupPreview:eb.Qj,activeStateValue:ed.Mn}),[c,u]=(0,n.useState)(null),[d,h]=(0,n.useState)(null),p=(0,n.useRef)(null),{handleDrag:v}=ax(),g=(0,n.useMemo)(()=>e.join("-")+t.join("-"),[e,t]);(0,n.useEffect)(()=>{d&&g&&c.nodes([d])},[g,d,c]);let y=(0,n.useCallback)(()=>{p.current=d.getChildren()},[d]),x=(0,n.useCallback)(()=>{l(p.current)},[l]),f=(0,n.useCallback)(()=>{i(Object.keys(p.current.reduce((e,t)=>({...e,[t.attrs.groupId]:""}),[])))},[i]),b=(0,n.useMemo)(()=>Object.values(a).filter(a=>e.includes(a.id)||t.includes(a.groupId)),[a,e,t]),w=(0,n.useMemo)(()=>b.map(e=>(0,n.createElement)(m.UL,{name:"objectTransformed",groupId:e.groupId,id:e.id,...e.shape,key:e.id})),[g]),D=(0,n.useCallback)((e,t)=>{let a=Y(128,128,1,1);return t.width<=128*s||t.height<=128*s?{...e,height:a.height*s,width:a.width*s}:t},[s]);(0,n.useEffect)(()=>{if(b.length>0){let e=null==d?void 0:d.getChildren();e&&(p.current=e,l(p.current))}},[d,b.length,l]);let k=(0,n.useCallback)(e=>{v(e),x()},[v,x]),C=(0,n.useMemo)(()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(m.ZA,{id:"selected-group-view",name:"objectGroup",onDragStart:y,onTransformStart:y,onDragEnd:f,onTransformEnd:f,draggable:!r,onTransform:x,onDragMove:k,ref:h,listening:!r,children:w},"gr"+g),(0,o.jsx)(m.$T,{keepRatio:!0,enabledAnchors:r?[]:["top-left","top-right","bottom-left","bottom-right"],rotateEnabled:!1,borderStroke:"#A8CE73",anchorFill:"rgba(168, 206, 115, 1)",anchorStroke:"#A8CE73",borderStrokeWidth:2,anchorSize:10,anchorCornerRadius:30,borderDash:[10,10],ref:u,name:"group-transformer",boundBoxFunc:D},"trans"+g)]}),[g,D,k,x,f,y,r,w]);return C};var aN=a(96186),aL=a.n(aN);let aZ=e=>{let{onDragEnd:t,onDragStart:a}=e,[s,l]=(0,n.useState)(!1),[o,i]=(0,n.useState)(!1),[r,c]=(0,n.useState)(null),[u,d]=(0,n.useState)(null),[h,p]=(0,n.useState)(!1),m=(0,n.useRef)(0),v=(0,n.useRef)(null),g=(0,n.useCallback)(e=>{if(s&&!h){var t,a,l,o,n;e.stopPropagation();let s=(null==e?void 0:null===(t=e.touches)||void 0===t?void 0:null===(a=t[0])||void 0===a?void 0:a.clientX)||e.clientX,i=(null==e?void 0:null===(l=e.touches)||void 0===l?void 0:null===(o=l[0])||void 0===o?void 0:o.clientY)||e.clientY,r=document.elementsFromPoint(s,i),u=r.find(e=>e.className.includes("objectItemWrap")||e.className.includes("groupWrap"));if(u){let t=u.getBoundingClientRect().top,a=u.getBoundingClientRect().height,s=t+a,l=u.getAttribute("data-dndgroupid"),o=u.getAttribute("data-dndobjectid"),i=u.getAttribute("data-insertenable"),r=u.getAttribute("data-dndtype"),d=u.getAttribute("data-index"),h=e.clientY||(null==e?void 0:null===(n=e.touches)||void 0===n?void 0:n[0].clientY);h<t+10&&c({groupId:l,objectId:o,index:parseInt(d),position:"top",type:r}),h>t+10&&h<s-10&&i&&c({groupId:l,objectId:o,index:parseInt(d),position:"middle",type:r}),h>s-10&&c({groupId:l,objectId:o,index:parseInt(d),position:"bottom",type:r})}}},[h,s]),y=(0,n.useCallback)(e=>{if(e.stopPropagation(),!h){var t;m.current=e.clientY||(null==e?void 0:null===(t=e.touches)||void 0===t?void 0:t[0].clientY);let a=e.currentTarget.getAttribute("data-dndgroupid"),s=e.currentTarget.getAttribute("data-dndobjectid"),l=e.currentTarget.getAttribute("data-index"),o=e.currentTarget.getAttribute("data-dndtype");d({groupId:a,objectId:s,index:parseInt(l),type:o}),i(!0)}},[h]),_=(0,n.useCallback)(e=>{if(e.stopPropagation(),!h){var t;m.current=e.clientY||(null==e?void 0:null===(t=e.touches)||void 0===t?void 0:t[0].clientY);let a=e.currentTarget.getAttribute("data-dndgroupid"),s=e.currentTarget.getAttribute("data-dndobjectid"),l=e.currentTarget.getAttribute("data-index"),o=e.currentTarget.getAttribute("data-dndtype");v.current=setTimeout(()=>{d({groupId:a,objectId:s,index:parseInt(l),type:o}),i(!0)},100)}},[h]),x=(0,n.useCallback)(e=>{clearTimeout(v.current),e.stopPropagation(),h&&e.preventDefault(),p(!0),setTimeout(()=>{o&&s&&(null==t||t(u,r)),l(!1),i(!1),c(null),p(!1)},50)},[h,o,s,t,u,r]),f=(0,n.useCallback)((e,t,n)=>{!o||s||r||h||(n.preventDefault(),n.stopPropagation(),Math.abs(e-t)>20&&(l(!0),a(u)))},[h,u,s,o,a,r]),b=(0,n.useCallback)(e=>{f(m.current,e.clientY,e)},[f]),w=(0,n.useCallback)(e=>{var t;clearTimeout(v.current),f(m.current,null==e?void 0:null===(t=e.touches)||void 0===t?void 0:t[0].clientY,e)},[f]);return(0,n.useEffect)(()=>(window.addEventListener("mousemove",b),window.addEventListener("touchmove",w,{passive:!1}),window.addEventListener("mouseup",x),window.addEventListener("touchend",x),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("touchmove",w),window.removeEventListener("mouseup",x),window.removeEventListener("touchend",x)}),[b,x,w]),{draggableProps:{onMouseDown:y,onTouchStart:_},droppableProps:{onMouseMove:g,onTouchMove:g},droppableParams:r,isInMove:s}};var aA=a(70671),aT=a.n(aA);let az=e=>{let{value:t,onValueSubmit:a,onSelect:s}=e,[l,i]=(0,n.useState)(null),r=(0,n.useRef)(null),[c,u]=(0,n.useState)(!1),d=(0,n.useRef)(null),h=(0,n.useCallback)(e=>{e.stopPropagation(),r.current?(clearTimeout(r.current),u(!0),d.current.focus(),r.current=null):r.current=setTimeout(()=>{r.current=null,s(e)},200)},[s]),p=(0,n.useCallback)(e=>{null==a||a(e.replace(/^\s\s*/,"").replace(/\s\s*$/,"").slice(0,500))},[a]),m=(0,n.useCallback)(()=>{(null==l?void 0:l.length)>0&&p(l),u(!1),i(null)},[p,l]),v=(0,n.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),i(e.target.value.replace(/^\s\s*/,"").slice(0,500))},[]),y=(0,n.useCallback)(e=>{["Enter","Escape"].includes(e.key)||e.stopPropagation()},[]),_=(0,n.useCallback)(e=>{"Enter"===e.key&&d.current.blur(),"Escape"===e.key&&(i(null),u(!1))},[]);return(0,o.jsxs)("div",{className:aT().root,onClick:h,children:[(0,o.jsx)("div",{className:g()(aT().placeholder,{[aT().hide]:c}),children:t}),(0,o.jsx)("input",{max:500,onKeyDownCapture:y,onBlur:m,ref:d,onChange:v,value:null!=l?l:t,className:g()(aT().input,{[aT().disabled]:!c,[aT().active]:c}),onKeyDown:_})]})},aY=()=>{let{list:e,objects:t,images:a,moveObject:s,selected:l,selectedGroups:i,moveGroup:r,preparingImg:c,updateObjetById:u,updateGroupById:d,clearSelected:h,isLayerOpen:p,previewImage:m,objectsCount:v,openedLayersGroup:y,setOpenedLayersGroup:_,addSelection:x,addSelectionGroup:f}=(0,j.eY)({list:W.RH,objects:W.hZ,images:W.lP,moveObject:eb.z2,moveGroup:eb.FB,selected:eh.J1,selectedGroups:eh.d1,updateObjetById:eb.p0,updateGroupById:eb.gS,clearSelected:eC,isLayerOpen:ed.g9,previewImage:W.IE,objectsCount:eK.RH,openedLayersGroup:ed.pc,setOpenedLayersGroup:k.sN,addSelection:ew,addSelectionGroup:ej,preparingImg:k.s2}),{selectGroupInLayers:b,selectObjectInLayers:w}=eA(),D=(0,n.useCallback)(e=>{"group"!==e.type||i.includes(e.groupId)||l.includes(e.objectId)||(h(),f(e.groupId)),"object"!==e.type||l.includes(e.objectId)||(h(),x(e.objectId))},[x,f,h,l,i]),C=(0,n.useCallback)((e,t)=>{(0,ep.F)("layer_list_do",{from:e,to:t})},[]),M=(0,n.useCallback)((t,a)=>{if(t&&a){let o=i.map(e=>({groupId:e,type:"group"})),n=l.map(t=>{let a=e.find(e=>e.objects.includes(t));return{objectId:t,groupId:null==a?void 0:a.id,type:"object"}});"group"!==t.type||o.find(e=>e.groupId===t.groupId)||o.push(t),"object"!==t.type||n.find(e=>e.objectId===t.objectId)||n.push(t),n.forEach(e=>{("object"!==t.type||t.objectId!==a.objectId)&&(s({from:e,to:a}),C(t,a))}),o.forEach(e=>{("group"!==t.type||t.groupId!==a.groupId)&&(r({from:e,to:a}),C(t,a))})}},[e,r,s,l,i,C]),{isInMove:E,draggableProps:P,droppableProps:I,droppableParams:F}=aZ({onDragEnd:M,onDragStart:D}),S=(0,n.useCallback)(e=>t=>{t.stopPropagation(),y[e]?_({id:e,state:!1}):_({id:e,state:!0})},[y,_]),R=(0,n.useCallback)((e,t)=>a=>{E||(a.stopPropagation(),"group"===e?b(t):w(t))},[E,b,w]),N=(0,n.useCallback)(e=>t=>{u({id:e,params:{name:t}}),(0,ep.F)("rename_layer_composition")},[u]),L=(0,n.useCallback)(e=>t=>{d({id:e,params:{name:t}}),(0,ep.F)("rename_layer_composition")},[d]),Z=(0,n.useCallback)(()=>{h()},[h]);return!p||m||0===v||c?null:(0,o.jsx)("div",{className:aL().root,style:{overflow:"auto"},onClick:Z,children:(0,o.jsx)("div",{...I,id:"sidebar-container",onClick:e=>e.stopPropagation(),className:aL().container,children:null==e?void 0:e.map((e,s)=>{var r,c,u,d,h,p;return(0,n.createElement)("div",{"data-dndtype":"group","data-insertenable":"1",...P,"data-dndgroupid":e.id,"data-index":s,"data-dndobjectid":(null==e?void 0:null===(r=e.objects)||void 0===r?void 0:r.length)===1?null==e?void 0:null===(c=e.objects)||void 0===c?void 0:c[0]:null,key:e.id,className:g()(aL().groupWrap,{[aL()["highlight-".concat(null==F?void 0:F.position)]]:(null==F?void 0:F.groupId)===e.id&&!(null==F?void 0:F.objectId)})},(0,o.jsxs)("div",{style:{pointerEvents:E&&(null==e?void 0:null===(u=e.objects)||void 0===u?void 0:u.length)===1?"none":"auto"},onClick:R("group",e.id),className:g()(aL().group,{[aL().opened]:y[e.id]&&e.objects.length>1,[aL().singleObject]:(null==e?void 0:null===(d=e.objects)||void 0===d?void 0:d.length)<=1}),children:[(null==e?void 0:null===(h=e.objects)||void 0===h?void 0:h.length)>1&&(0,o.jsxs)("div",{style:{pointerEvents:E?"none":"auto"},className:g()(aL().groupItem,{[aL().selected]:null==i?void 0:i.includes(e.id)}),children:[(0,o.jsx)("img",{className:aL().preview,alt:"image-preview",src:a[e.preview]}),(0,o.jsx)(az,{onSelect:R("group",e.id),value:e.name,onValueSubmit:L(e.id)}),(0,o.jsx)("div",{className:aL().arrow,onClick:S(e.id),children:(0,o.jsx)(e2.Z,{name:"ic_16_arrow_outline_up"})})]}),(0,o.jsx)("div",{className:aL().objectsList,children:null==e?void 0:null===(p=e.objects)||void 0===p?void 0:p.map((s,r)=>{var c,u;let d=t[s],h=(null==e?void 0:null===(c=e.objects)||void 0===c?void 0:c.length)>1?P:{};return(0,n.createElement)("div",{...h,"data-dndobjectid":s,"data-dndgroupid":e.id,"data-dndtype":"object","data-index":r,key:s,className:g()(aL().objectItemWrap,{[aL().singleObject]:(null==e?void 0:null===(u=e.objects)||void 0===u?void 0:u.length)<=1,[aL()["highlight-".concat(null==F?void 0:F.position)]]:(null==F?void 0:F.objectId)===s}),onClick:R("object",d.id)},(0,o.jsxs)("div",{className:g()(aL().objectItem,{[aL().selected]:(null==l?void 0:l.includes(d.id))||(null==i?void 0:i.includes(e.id))&&e.objects.length<=1}),children:[(0,o.jsx)("img",{alt:"image-preview",src:a[d.imageId],className:aL().preview}),(0,o.jsx)(az,{onSelect:R("object",d.id),value:d.name,onValueSubmit:N(d.id)})]}))})})]}))})})})};var aG=a(51732),aB=a.n(aG);let aO=()=>{var e,t;let[a,s,l,i,r,c,u,d,h,p,{isEraserActive:v,isImagePreviewActive:y},x,f,w,C,M,E,P]=(0,j.eY)([_.T9,_.$C,N,b,ee,J,Z,_.KN,k.s2,W.IE,ed.Mn,eM,eH.w,t7,ed.uS,ed.cc,eb.FS,af]),[I,F]=e0(),S=(0,n.useMemo)(()=>h,[h]),R=(0,n.useCallback)(e=>{if(!S)return;let t="Изменения могут не сохраниться.";return(e||window.event).returnValue=t,t},[S]);(0,n.useEffect)(()=>(window.addEventListener("beforeunload",R),()=>{window.removeEventListener("beforeunload",R)}),[R]);let{onWheel:L,onTouchMove:A,onTouchEnd:T,onTouchStart:z,onMouseMove:Y,onMouseUp:G,onMouseDown:B,isMouseDown:O,onMouseEnter:U,onMouseLeave:$}=a_(),{selectByClick:V}=eA();aj(),(0,n.useEffect)(()=>{d||(l(),i(),r(),c(),(0,eY.eb)(),u())},[r,l,u,d,c,i,I]),eG(),(0,n.useEffect)(()=>{d||setTimeout(()=>{let e=document.getElementById("textAreaAutoFocus");e&&e.focus()},400)},[d]);let H=(0,n.useCallback)(()=>{E()},[E]);(0,n.useEffect)(()=>{H();let e=setInterval(H,6e4);return()=>clearInterval(e)},[H]);let q=(0,n.useMemo)(()=>10*w,[w]),X=(0,n.useMemo)(()=>!C&&v&&!h,[v,C,h]),K=(0,n.useCallback)(e=>t=>{P({refKey:e,refValue:t})},[P]),Q=(0,n.useMemo)(()=>(0,o.jsx)(m.Cd,{ref:K("eraserNodeRef"),fill:"rgba(211, 253, 122, 0.07)",width:q||0,height:q||0,stroke:"#A8CE73",x:-1e3,y:-1e3,opacity:0,visible:X,strokeWidth:1,listening:!1,perfectDrawEnabled:!1,shadowEnabled:!1,globalCompositeOperation:"difference"}),[X,q,K]);return(0,o.jsxs)("div",{style:{touchAction:"none"},className:g()(aB().canvas,{[aB().selectHovered]:M&&!C,[aB().selectMoved]:M&&O,[aB().drag]:C,[aB().dragActive]:C&&O,[aB().eraserActive]:v&&!C}),children:[(0,o.jsx)(aY,{}),(0,o.jsx)(aS,{}),(0,o.jsx)(aE,{}),(0,o.jsx)(ak.Z,{}),(0,o.jsx)(au,{}),(0,o.jsxs)(m.Hf,{width:I,height:F,scale:{x:s.value,y:s.value},ref:K("stageNodeRef"),onWheel:L,onTouchMove:A,onTouchStart:z,onTouchEnd:T,onMouseDown:B,onMouseMove:Y,onMouseUp:G,onMouseEnter:U,onMouseLeave:$,onClick:V,onTap:V,x:a.x,y:a.y,shadowEnabled:!1,perfectDrawEnabled:!1,children:[(null==f?void 0:null===(e=f.path)||void 0===e?void 0:e.length)&&(0,o.jsxs)(m.mh,{ref:K("eraserObjectsRef"),children:[(0,o.jsx)(eJ,{forEraser:!0}),(0,o.jsx)(m.x1,{hitStrokeWidth:0,shadowForStrokeEnabled:!1,perfectDrawEnabled:!1,stroke:"blue",strokeWidth:q,lineCap:"round",lineJoin:"round",opacity:0,points:(null==f?void 0:null===(t=f.path)||void 0===t?void 0:t.length)!==0?null==f?void 0:f.path:[],ref:K("tempEraseRef")})]}),(0,o.jsxs)(m.mh,{x:-a.x/s.value,y:-a.y/s.value,globalCompositeOperation:"source-over",listening:!1,children:[(0,o.jsx)(m.UL,{width:I/s.value,height:F/s.value,fill:"#292929"}),(0,o.jsx)(D,{})]}),(0,o.jsxs)(m.mh,{children:[(0,o.jsxs)(m.ZA,{ref:K("mainLayerNodeRef"),children:[(0,o.jsx)(eJ,{}),p&&(0,o.jsx)(aD,{previewImage:p},p.id),!h&&x&&(0,o.jsx)(aR,{})]}),(0,o.jsx)(m.ZA,{ref:K("secondLayerNode"),children:(0,o.jsx)(ab,{isShowed:!y&&!h&&!x&&!v})}),(0,o.jsxs)(m.ZA,{x:-a.x/s.value,y:-a.y/s.value,children:[(0,o.jsx)(eu,{isShowed:!y&&!h&&!x}),Q]})]})]}),(0,o.jsx)(ay,{style:{left:"16px",position:"absolute",bottom:"0"}}),(0,o.jsx)("canvas",{id:"temp-canvas",style:{position:"fixed",left:"-100000px",top:"-1000000px"}})]})},aU=()=>{let{removeSidebarBadgeStatus:e,checkFailedPreviewIds:t}=(0,j.eY)({removeSidebarBadgeStatus:k.Wg,checkFailedPreviewIds:eb.cl}),{showModal:a}=(0,h.dd)(),[s,l]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{l(!0),localStorage.getItem("fb-rules-accept")||a("RULES_MODAL"),document.addEventListener("contextmenu",e=>e.preventDefault())},[]),(0,n.useEffect)(()=>{e("generate"),setTimeout(()=>{t()},1e3)},[t,e]),s)?(0,o.jsx)(d,{children:(0,o.jsx)(i.Z,{activePage:"editor",children:(0,o.jsx)(aO,{})})}):(0,o.jsx)(p.Z,{})};var a$=!0,aV=aU},80209:function(e){e.exports={root:"styles_root__TOrkw",clear:"styles_clear__W99WX",fill:"styles_fill__5T7eK",primary:"styles_primary__Ikm9o"}},91214:function(e){e.exports={root:"styles_root__jaYMd"}},92901:function(e){e.exports={overlay:"styles_overlay__CVGnV",hidden:"styles_hidden__QDC9S",wrap:"styles_wrap__TARnH",content:"styles_content___ba0f",footer:"styles_footer__Iid9M",right:"styles_right__DFaJB",fillColumn:"styles_fillColumn__F5Wz7",fillRow:"styles_fillRow__02478"}},64989:function(e){e.exports={buttonWrap:"styles_buttonWrap__51MYG",disabled:"styles_disabled__3lmlZ",isOpen:"styles_isOpen__g0S2F",buttonIcon:"styles_buttonIcon__cjw0h",opened:"styles_opened__6B7rm",title:"styles_title__ILU_M",wrapper:"styles_wrapper__QNLtS",content:"styles_content__TWQCX",listItem:"styles_listItem__qiEfc",icon:"styles_icon__tTCiR",selected:"styles_selected__wA1Qd"}},5126:function(e){e.exports={root:"styles_root__ML2I4",container:"styles_container__dcDeo",smile:"styles_smile__6o_wf",rangewrapper:"styles_rangewrapper__pwgU3",customrange:"styles_customrange__ou7FO",sliderfill:"styles_sliderfill__uGPTk",sliderthumb:"styles_sliderthumb__cy_s2",slidergray:"styles_slidergray__n3G5y"}},76269:function(e){e.exports={root:"styles_root__D82Sx",hovered:"styles_hovered__7CYZQ",active:"styles_active__VCmAB",tooltip:"styles_tooltip__ZhJYc",tip:"styles_tip__xzSp5",tipSecond:"styles_tipSecond__Drwdb"}},80556:function(e){e.exports={root:"styles_root__U_C3m",tabs:"styles_tabs__mKsmN",tab:"styles_tab__RyBAg",active:"styles_active__uuzXZ",reset:"styles_reset__kPa6s",error:"styles_error__TfSn1",content:"styles_content__1p72S",controlled:"styles_controlled__NozzK",submit:"styles_submit__ahPJA",submitContent:"styles_submitContent__gMJs6",keyCode:"styles_keyCode__xQKUw",errorCount:"styles_errorCount__hcfE5"}},98315:function(e){e.exports={styleItem:"styles_styleItem__mcea9",withValue:"styles_withValue__Rrxtm",name:"styles_name__KQLm5",select:"styles_select__eY2FR",stylesList:"styles_stylesList__tfZxS"}},85529:function(e){e.exports={textAreaWrap:"styles_textAreaWrap__ZNSkT",textArea:"styles_textArea__rOuaH",error:"styles_error__FqiXf",textViewArea:"styles_textViewArea__B1UJb",infoIcon:"styles_infoIcon__HsmfG",active:"styles_active__BUQk7",artGptHint:"styles_artGptHint__SVZMY",artGptToggle:"styles_artGptToggle__VwFCn"}},70671:function(e){e.exports={root:"styles_root__bhWGt",input:"styles_input__uNR_y",disabled:"styles_disabled__gvv6v",active:"styles_active__UU0pM",placeholder:"styles_placeholder__Ham9l",hide:"styles_hide__ATHz_"}},88791:function(e){e.exports={root:"styles_root__Z7Z1L",cancel:"styles_cancel__raOTz",hint:"styles_hint__6ByZF",loadIcon:"styles_loadIcon__vCjtD",rotator:"styles_rotator__yoxlp"}},79914:function(e){e.exports={header:"styles_header__sinBC",body:"styles_body__7kmDv",key:"styles_key__7namP",content:"styles_content__vPKjx",row:"styles_row__Ik1o3",keys:"styles_keys__dEZr4"}},46134:function(e){e.exports={selectItem:"styles_selectItem__PG3DP",eraserActive:"styles_eraserActive__ojL6q",info:"styles_info__z3dxq",size:"styles_size__TSy_b",side:"styles_side__cWc7_",active:"styles_active__VxZhn",sizeList:"styles_sizeList__IT2Gc",buttons:"styles_buttons__JHBXk",acceptButton:"styles_acceptButton__t_AD6",cancelButton:"styles_cancelButton__MefXj"}},28531:function(e){e.exports={root:"styles_root__AGfwu",container:"styles_container__1fogt",name:"styles_name__7HmeJ",sliderWrap:"styles_sliderWrap__AFTMP",eraserSliderWrap:"styles_eraserSliderWrap__n9UZa",value:"styles_value__3bwQB",optionButton:"styles_optionButton__ecHNt",buttons:"styles_buttons__4KfsU",resetSettings:"styles_resetSettings__UqEX3",row:"styles_row__Grcx8",eraseHint:"styles_eraseHint__xqySv",eraseHintText:"styles_eraseHintText__g8Ke7",generateHint:"styles_generateHint__mtUS0",infoIcon:"styles_infoIcon__bbt8J"}},18536:function(e){e.exports={panel:"styles_panel__UlilG",rightPanel:"styles_rightPanel__b2FyS",uploadButton:"styles_uploadButton__7G0Mz",zoomWrap:"styles_zoomWrap__5BET3",zoomInput:"styles_zoomInput__SHJ3d",separate:"styles_separate__GW4G3",optionButton:"styles_optionButton__5e_Ro",downloadIcon:"styles_downloadIcon__UWnHW",count:"styles_count__NHUjl"}},12593:function(e){e.exports={visible:"styles_visible__5L2Yv",wrap:"styles_wrap__erzrS",text:"styles_text__H2JsL",button:"styles_button__DRuyZ"}},69769:function(e){e.exports={dropzone:"styles_dropzone__7fYnf",preparingImg:"styles_preparingImg__BUtTE",dropzoneActive:"styles_dropzoneActive__zkRyw",dragRejected:"styles_dragRejected__LnFMY"}},96186:function(e){e.exports={root:"styles_root__ZYxNO",container:"styles_container__zE2EN",groupWrap:"styles_groupWrap__BeWUy",group:"styles_group__Hgnps",singleObject:"styles_singleObject__eT7ju",objectsList:"styles_objectsList__8MNvw",objectItem:"styles_objectItem__Fk8lH",opened:"styles_opened__2KT_u",arrow:"styles_arrow__o9lyb",groupItem:"styles_groupItem__9uymF",objectItemWrap:"styles_objectItemWrap__HET_M","highlight-bottom":"styles_highlight-bottom__2tUoz","highlight-top":"styles_highlight-top__3E5bH",name:"styles_name__Y1kwr",preview:"styles_preview__wh_pR",selected:"styles_selected__2AwBC","highlight-middle":"styles_highlight-middle__0MS9c"}},10630:function(e){e.exports={selectItem:"styles_selectItem__jXvXg",info:"styles_info__7e4tn",size:"styles_size__xxmmF",metaView:"styles_metaView__rD7fs",groupShapeBorder:"styles_groupShapeBorder__XwODF"}},51732:function(e){e.exports={canvas:"styles_canvas__lGpoM",drag:"styles_drag__Y3YDl",selectHovered:"styles_selectHovered__62GY9",dragActive:"styles_dragActive__5X3Ib",selectMoved:"styles_selectMoved__rV_Me",eraserActive:"styles_eraserActive__dcZK_"}},42639:function(e){e.exports={active:"styles_active__YRO07","anim_24_sparks-u-6":"styles_anim_24_sparks-u-6__UjcCy","anim_24_sparks-u-6_c_o":"styles_anim_24_sparks-u-6_c_o__RgZWH","anim_24_sparks-u-5":"styles_anim_24_sparks-u-5__gjOBh","anim_24_sparks-u-5_c_o":"styles_anim_24_sparks-u-5_c_o__E_114","anim_24_sparks-u-4":"styles_anim_24_sparks-u-4__5pxXa","anim_24_sparks-u-4_c_o":"styles_anim_24_sparks-u-4_c_o__EStNJ","anim_24_sparks-u-3":"styles_anim_24_sparks-u-3__C893_","anim_24_sparks-u-3_c_o":"styles_anim_24_sparks-u-3_c_o__FJK_S","anim_24_sparks-u-2":"styles_anim_24_sparks-u-2__SQ4bf","anim_24_sparks-u-2_c_o":"styles_anim_24_sparks-u-2_c_o__wn7KQ","anim_24_sparks-u-1":"styles_anim_24_sparks-u-1__mNT1E","anim_24_sparks-u-1_c_o":"styles_anim_24_sparks-u-1_c_o__Adqf7"}},86779:function(e){e.exports={root:"styles_root__Zanqx"}},2485:function(e){e.exports={root:"styles_root__HkEOz"}},28464:function(e){e.exports={root:"styles_root__ONxhL"}},34674:function(e){e.exports={root:"styles_root__R6bcZ"}},10857:function(e){e.exports={root:"styles_root__m_IGB"}}},function(e){e.O(0,[8062,7066,5859,8478,3920,2282,9398,3301,1168,9908,9774,2888,179],function(){return e(e.s=96281)}),_N_E=e.O()}]);